---

title: modeling.text_generation

keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, loss functions, custom splitters, etc... for token classification tasks like summarization."
description: "This module contains custom models, loss functions, custom splitters, etc... for token classification tasks like summarization."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02e_modeling-text-generation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#cuda</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Text-generation">Text generation<a class="anchor-link" href="#Text-generation"> </a></h2><p>The objective of text generation is to create reasonable textual responses given a prior piece of input.  For example, we may want to summarize an article in a single sentence or have a chatbot provide a sensible response to a question.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span>
<span class="n">cnndm_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;cnndm_sample.csv&#39;</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">cnndm_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1000</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cnndm_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article</th>
      <th>highlights</th>
      <th>ds_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(CNN)  -- Globalization washes like a flood over the world's cultures and economies. Floods can be destructive; however, they can also bring blessings, as the annual floods of the Nile did for ancient Egypt. The world's great universities can be crucial instruments in shaping, in a positive way, humankind's reaction to globalization and the development of humankind itself. Traditionally, universities have been defined and limited by location, creating an academic community and drawing students and scholars to that place. Eventually, some universities began to encourage students to study el...</td>
      <td>John Sexton: Traditionally, universities have been defined and limited by location .\nGlobal campuses form a network of thought, innovation, he writes .\nFaculty can teach, Sexton says, students can team up in many cities at once .\nSexton: Research, scholarship can be shared and cultural ties made in "century of knowledge"</td>
      <td>train</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(CNN) -- Armenian President Robert Kocharian declared a state of emergency Saturday night after a day of clashes between police and protesters, a spokeswoman for the Armenian Foreign Ministry said. Opposition supporters wave an Armenian flag during a protest rally in Yerevan, Armenia, on Saturday. The protesters claim last month's presidential election was rigged. The state of emergency will "hopefully bring some order" to the capital, Yerevan, said Salpi Ghazarian, assistant to the Armenian foreign minister, who spoke to CNN early Sunday. The state of emergency could last until March 20, ...</td>
      <td>NEW: Protest moves after crackdown at Freedom Square .\nOrder sought after protests over last month's election turn violent .\nDemonstrators say the election was fraudulent .\nState of emergency could last until March 20, official says .</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;facebook/bart-large-cnn&quot;</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> 
                                                                               <span class="n">model_cls</span><span class="o">=</span><span class="n">BartForConditionalGeneration</span><span class="p">)</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_config</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;bart&#39;,
 transformers.configuration_bart.BartConfig,
 transformers.tokenization_bart.BartTokenizer,
 transformers.modeling_bart.BartForConditionalGeneration)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span> 
    <span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">),</span> 
    <span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">ConditionalGenerationTask</span><span class="p">(),</span> <span class="n">trg_max_length</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;article&#39;</span><span class="p">),</span> 
                   <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;highlights&#39;</span><span class="p">),</span> 
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">cnndm_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([4, 512]), torch.Size([4, 250]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(CNN Student News) -- October 27, 2009. Downloadable Maps. Download PDF maps related to today's show:  • Afghanistan &amp; Pakistan • Los Angeles &amp; San Diego • Ft. Jackson, South Carolina. Transcript. THIS IS A RUSH TRANSCRIPT. THIS COPY MAY NOT BE IN ITS FINAL FORM AND MAY BE UPDATED. NATISHA LANCE, CNN STUDENT NEWS ANCHOR: A member of the military is making history. We'll explain how in today's edition of CNN Student News. Hi, everyone. Carl Azuz is off this week. I'm Natisha Lance. First Up: Afghan Crashes. LANCE: First up, Pakistan and Afghanistan. The countries share a border, and they also share a common problem: threats from militant groups and terrorists like the Taliban and al Qaeda. It's an issue facing both nations' governments, and one that the U.S. government is concerned about as well. That's why President Obama has been holding a series of meetings with some of his advisers. They're reviewing the U.S. strategy in Afghanistan and Pakistan. Samantha Hayes has the latest on those meetings and on the violence in the region. (BEGIN VIDEO) SAMANTHA HAYES, CNN CORRESPONDENT, WASHINGTON, D.C.: Two helicopter crashes make it the deadliest day in four years for Americans in Afghanistan. While a NATO security force spokesman says enemy fire is not to blame, the loss of 14 Americans comes while President Barack Obama is considering a request to send thousands more troops to the region to fight al Qaeda. The president addressed service men and women in Jacksonville, Florida Monday, after a White House meeting with his national security team. U.S. PRESIDENT BARACK OBAMA: Fourteen Americans gave their lives, and our prayers are with these service members, their civilian colleagues and the families who loved them. HAYES: The deadliest of the two crashes happened following a raid on suspected drug traffickers, and three DEA agents were among those killed. Also among the dead, three U.S. civilians, members of the embassy community. The State Department says the efforts of civilians and other nonmilitary personnel are essential to the overall mission. JACOB LEW, DEPUTY SECRETARY OF STATE: Improving Afghan governance, providing security, justice, jobs and services, and giving the Afghan people a meaningful alternative, as much as possible, to the Taliban's recruiting. HAYES: Democratic Senator John Kerry, off</td>
      <td>Consider U.S. efforts to offer Afghan citizens an alternative to the Taliban.\nHear how a proposed health care bill addresses the issue of the public option.\nMeet a soldier who is making history at the U.S. Army Drill Sergeant School.\nUse the Daily Discussion to help students understand today's featured news stories.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(CNN Student News) -- March 23, 2010. Download PDF maps related to today's show:. • Haiti • China. Transcript. THIS IS A RUSH TRANSCRIPT. THIS COPY MAY NOT BE IN ITS FINAL FORM AND MAY BE UPDATED. CARL AZUZ, CNN STUDENT NEWS ANCHOR: Happy birthday, Roger Bannister -- first man to run the mile in less than four minutes. In more than twice that time, you'll be up to speed on today's headlines. I'm Carl Azuz. First Up: Health Care. AZUZ: First up, it's the biggest expansion of the United States health care system in more than forty years. And by a vote of 219-212, the U.S. House of Representatives passed a health care reform bill late Sunday night. This is the same bill that the Senate passed last December. This means that when President Obama signs it, it's law. The House also passed a set of changes to the Senate bill. We're gonna get back to that in just a second. But first, you know this health care issue has been controversial. We want you to check out some of the reaction to last night's vote. REP. NANCY PELOSI, (D) HOUSE SPEAKER: Thirty-two million more Americans having access to health care. $1.3 trillion saved for the taxpayer and accountability for the insurance companies so they cannot come between patients and their doctors. REP. JOHN BOEHNER, (R) HOUSE MINORITY LEADER: Shame on us. Shame on this body. Shame on each and every one of you who substitutes your will and your desires above those of your fellow countrymen. BARACK OBAMA, PRESIDENT OF THE UNITED STATES: This legislation will not fix everything that ails our health care system, but it moves us decisively in the right direction. This is what change looks like. AZUZ: Okay, so the House passed the bill. Now what? Well, President Obama is expected to sign it today. Again, as soon as he does that, the Senate bill becomes law. But how about those changes passed by the House? Those still need to get through the Senate. That process can't start until  the president signs the original bill. Some analysts are saying that the package of changes could inspire a pretty heated battle in the Senate. We're going to have more on that as the debate gets going. Another thing that's</td>
      <td>Find out what comes next after the passage of a health care reform bill.\nLearn about a proposal that would change how student loans are funded.\nFollow the steps that led to a showdown between China and Google.\nUse the Daily Discussion to help students understand today's featured news stories.</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_TextGenerationModelWrapper" class="doc_header"><code>class</code> <code>HF_TextGenerationModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/text_generation.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_TextGenerationModelWrapper</code>(<strong><code>hf_model</code></strong>) :: <a href="/blurr/modeling-core#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In additiont to updating our model wrapper to allow us to include <code>decoder_input_ids</code>, below we add a custom param splitter to give us a bit more depth in applying discriminative learning rates.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="text_gen_splitter" class="doc_header"><code>text_gen_splitter</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/text_generation.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>text_gen_splitter</code>(<strong><code>m</code></strong>, <strong><code>arch</code></strong>)</p>
</blockquote>
<p>Custom param splitter for text generation models</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_TextGenerationModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">ranger</span><span class="p">,</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span><span class="p">),</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">text_gen_splitter</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">))</span><span class="c1">#.to_fp16()</span>

<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span> 
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([4, 250, 50264]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, 4, torch.Size([4, 512]), 4, torch.Size([4, 250]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.017378008365631102, lr_steep=7.585775847473997e-07)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>3.585893</td>
      <td>3.168727</td>
      <td>01:11</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3.516942</td>
      <td>3.158353</td>
      <td>01:11</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3.510635</td>
      <td>3.156650</td>
      <td>01:12</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(CNN) -- Home to up to 10 percent of all known species, Mexico is recognized as one of the most biodiverse regions on the planet. The twin threats of climate change and human encroachment on natural environments are, however, threatening the existence of the country's rich wildlife. And there is a great deal to lose. In the United Nations Environment Program (UNEP) World Conservation Monitoring Centre's list of megadiverse countries Mexico ranks 11th. The list represents a group of 17 countries that harbor the majority of the Earth's species and are therefore considered extremely biodiverse. From its coral reefs in the Caribbean Sea to its tropical jungles in Chiapas and the Yucatan peninsula and its deserts and prairies in the north, Mexico boasts an incredibly rich variety of flora and fauna. Some 574 out of 717 reptile species found in Mexico -- the most in any country -- can only be encountered within its borders. It is home to 502 types of mammals, 290 species of birds, 1,150 varieties of birds and 26,000 classifications of plants. Pronatura, a non-profit organization that works to promote conservation and sustainable development in Mexico, has selected six species which it says symbolize the problems faced by the destruction of nature. "These are only some of the species which have some degree of conservation," says Eduardo Cota Corona, Director of Conservation at Pronatura. "However, there is a countless number of species in Mexico which find themselves in danger of extinction." Golden Eagle. It is the country's national symbol yet the Golden Eagle is close to extinction in Mexico. One of the largest raptors or birds of prey in the world, the Golden Eagle's wingspan can reach lengths greater than two metres. Only the Bald Eagle and the California Greater exceed it in size in North America. With its powerful hooked bill and long and sharp claws it can sometimes capture prey of a size that is surprising for its size, including crane, wild ungulates and domestic livestock, though more often than not it tends to feed off small mammals such as rabbits, hares, ground squirrels and prairie dogs as well as reptiles and small-to-medium sized birds. Primarily a solitary bird, the Golden Eagle pairs up to breed, building nests made of dry branches in cliffs and escarpments. The female typically lays two eggs which are incubated by both the male and female. Usually, only one of the hatchlings survives. The Golden Eagle can be found in</td>
      <td>Mexico hosts to up to 10 percent of all known species on Earth.\nIt is home to 502 types of mammals, 290 bird species and 26,000 types of plants.\nHuman development and climate change is placing a big strain on its biodiversity.\nThe Golden Eagle is under threat in spite of being the country's national symbol.</td>
      <td>Mexico. up 10 to 10 percent of all known species. the. The threats is home to 502 types of mammals, 290 species species and 26,000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ATLANTA, Georgia (CNN) -- The company name flashed and swirled around the darkened convention hall as the music began to pump. Before squeezing into Body Magic, a before-and-after volunteer is measured by Monica Bennett. "Money money money money, money! Money money money money, money!" A man dressed in designer duds strutted across the stage to the tune of The O'Jays' 1970s hit, now the theme song for "The Apprentice." "If you want to get paid, you've got to get up on your feet," he called out. "They say money doesn't grow on trees. Well, I've got a money tree in my backyard, and Ardyss planted it there!" With that the faithful rose and hollered, the applause crescendoed, and the smiles - and dreams - spread wide.  See how the sales pitch works ». Few issues pique public interest more than opportunities to make money and achieve beauty. The estimated 3,000 people from around the country who streamed into the Georgia World Congress Center in Atlanta in early August were a testament to that. They came to rally around Ardyss International, a Las Vegas, Nevada-based direct sales company that makes a fortune off undergarments. Body Magic, the company's flagship girdle-and-corset combo, which retails for $140 plus tax and shipping, can "bring your butt back to high school fine," the man on stage announced. You can wear it and get thin, the claims go, or you can sell it and get rich. The company's other products include the Angel Bra, Panty Reshaper, undergarments for men, nutritional supplements and skin-care items. Think Mary Kay cosmetics. That's the kind of multilevel or network marketing model on which Ardyss is based. Distributors can make money through sales. But they can make even more from profit cuts and bonuses that float to the top if they recruit other distributors, who in turn recruit other distributors, and so on and so on. "I've only been involved for two months, and I have a check with a comma in it," said Robbyn Washington of Snellville, Georgia. While many such companies are legitimate, others smack of pyramid schemes, prompting legal disputes and investigations by consumer protection agencies such as the Federal Trade Commission. The FTC has no complaints about Ardyss International on file. But the Better Business Bureau, with which Ardyss</td>
      <td>Company behind Body Magic booms amid claims of big money, smaller waistlines.\nMultilevel marketing businesses draw interest and spur hope during recession.\nStaying cautious and realistic is important for prospective distributors.\nHLN money expert Clark Howard: "Don't believe it's paved in gold"</td>
      <td>&lt;s&gt;. Ar Magic.ob. sales of beauty money. beauty waistlines. Some.ilevel or model can interest from sometimes legal, economic. FTCs</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The predictions of our <code>show_results</code> are the greedy predicted values from the model. <code>Learner.predict</code> will follow the same approach.</p>
<p>Below we'll look at how we can use huggingface's <code>PreTrainedModel.generate</code> method to create something more reasonable.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_article</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">To Disney or not to Disney? For many travelers, especially those with children, it&#39;s not even a question they ask. </span>
<span class="s2">They already know the answer. &quot;Yes.&quot; To these visitors, Disney is Mickey Mouse, princesses, magic and fun. It&#39;s </span>
<span class="s2">happy memories of childhood brought back to life in your children, a clean place where the rides are safe and the </span>
<span class="s2">Disney characters are always happy to pose for pictures with your kids. That&#39;s Deb Koma, who visited once as a </span>
<span class="s2">child and walked back into the Magic Kingdom in the mid-1990s with her young son. &quot;It was so perfect, everybody </span>
<span class="s2">was so happy, everything was so maintained,&quot; said Koma, who now works for the AllEars.net, an unofficial Disney </span>
<span class="s2">planning and fan site. &quot;You were in a perfect fantasy world. That, and my little boy loved it.&quot; But for other </span>
<span class="s2">vacationers, Disney inspires a firm &quot;no.&quot; To those travelers, Disney is merely a commercial machine built to </span>
<span class="s2">sell tickets, overpriced toys and a stereotype of girls as princesses. They may remember visiting Disneyland </span>
<span class="s2">or Disney World when they were children, but they aren&#39;t taking their kids there. Downtown Disney to make way </span>
<span class="s2">for Disney Springs. That&#39;s the Rev. J.C. Mitchell, who will be heading to Orlando, Florida, this year for a work </span>
<span class="s2">conference but will not be taking his family with him, even though his job will cover most of the costs of his </span>
<span class="s2">trip. &quot;We do not enjoy Disney,&quot; wrote Mitchell, who went to Disney World as a child, via e-mail. &quot;We believe </span>
<span class="s2">it symbolically represents the excesses of our extremely individualistic society.&quot; What is it about Disney </span>
<span class="s2">that creates such a strong response from its dedicated fans and foes? Whether you love or hate or merely </span>
<span class="s2">tolerate the expansion of what Walt Disney started in 1923, there&#39;s no doubting that Disney is popular </span>
<span class="s2">and its influence is everywhere. All of those theme parks, resorts, cruises, movies, television shows, </span>
<span class="s2">toys and other Disney businesses earned the company  11.3𝑏𝑖𝑙𝑙𝑖𝑜𝑛𝑖𝑛𝑡ℎ𝑒𝑙𝑎𝑠𝑡𝑡ℎ𝑟𝑒𝑒𝑚𝑜𝑛𝑡ℎ𝑠𝑜𝑓2012.𝑀𝑜𝑟𝑒𝑡ℎ𝑎𝑛 3 billion </span>
<span class="s2">of that money came from Disney cruises and its 11 theme parks and 43 resorts across North America, Europe </span>
<span class="s2">and Asia. One more park is under construction in Shanghai. People like Disney. It ranked as the third most </span>
<span class="s2">well-regarded company--behind only Amazon.com and Apple--in a recent Harris Interactive survey of people&#39;s </span>
<span class="s2">opinions of the most visible companies&#39; reputations. </span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_article</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">150</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>DisneyDisney. some fans not to Disney? For many travelers, the those with children, it&#39;s not even a question they ask. To                , already kno
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That doesn't look much like a human-generated summary.  Let's use huggingface's <code>PreTrainedModel.generate</code> method to create something more human-like.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_input_ids</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">train_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">hf_model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="n">gen_text</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">hf_model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">test_input_ids</span><span class="p">,</span> <span class="n">num_beams</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=== Target ===&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clean_up_tokenization_spaces</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=== Prediction ===&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">gen_text</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clean_up_tokenization_spaces</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=== Target ===
 Dorothy Brown: Missouri Gov. Nixon appointed highway patrol chief to take over in Ferguson .
She says lesson of Michael Brown case: underrepresented black citizens must vote .
Most Ferguson citizens are black, but power structure dominated by whites, she says .
Brown: Police out of control; young man is dead. Citizens should respond at ballot box .

=== Prediction ===
Missouri Gov. Jay Nixon appointed Capt. Ron Johnson of the Missouri State Highway Patrol to take over the security on the ground in Ferguson. The miracle of Ferguson is that the citizens have had the courage to stand up to a power structure that generally does not include them.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll add a <code>generate_text</code> method to <code>Learner</code> that uses huggingface's <code>PreTrainedModel.generate</code> to create our predictions.</p>
<p>For the full list of arguments you can pass in see <a href="https://huggingface.co/transformers/main_classes/model.html#transformers.PreTrainedModel.generate">here</a>. You can also check out their <a href="https://github.com/huggingface/blog/blob/master/notebooks/02_how_to_generate.ipynb">"How To Generate"</a> notebook for more information about how it all works.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.generate_text" class="doc_header"><code>Learner.generate_text</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/text_generation.py#L55" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.generate_text</code>(<strong><code>inp</code></strong>, <strong><code>max_length</code></strong>=<em><code>130</code></em>, <strong><code>min_length</code></strong>=<em><code>30</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Uses the built-in <code>generate</code> method to generate the text
(see <a href="https://huggingface.co/transformers/main_classes/model.html#transformers.PreTrainedModel.generate">here</a>
for a list of arguments you can pass in)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">generate_text</span><span class="p">(</span><span class="n">test_article</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_beams</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== Prediction </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> ===</span><span class="se">\n</span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=== Prediction 1 ===
Disney has 11 theme parks and 43 resorts across North America, Europe, Asia. It ranked as the third most well-regarded company in a recent Harris Interactive survey. The Rev. J.C. Mitchell: &#34;We do not enjoy Disney&#34;

=== Prediction 2 ===
Disney has 11 theme parks and 43 resorts across North America, Europe, Asia. It ranked as the third most well-regarded company in a recent Harris Interactive survey. The Rev. J.C. Mitchell: &#34;We do not enjoy Disney.&#34;

=== Prediction 3 ===
Disney has 11 theme parks and 43 resorts across North America, Europe, Asia. It ranked as the third most well-regarded company in a recent Harris Interactive survey.

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Much nicer!!! What about inference?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;text_gen_learn_export.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;text_gen_learn_export.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">generate_text</span><span class="p">(</span><span class="n">test_article</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Disney has 11 theme parks and 43 resorts across North America, Europe, Asia. It ranked as the third most well-regarded company in a recent Harris Interactive survey. The Rev. J.C. Mitchell: &#34;We do not enjoy Disney&#34;&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

