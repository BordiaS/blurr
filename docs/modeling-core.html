---

title: modeling.core

keywords: fastai
sidebar: home_sidebar

summary: "This module contains core custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your huggingface models trained via fastai"
description: "This module contains core custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your huggingface models trained via fastai"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_modeling-core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#cuda</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Base-splitter,-model-wrapper,-and-model-callback">Base splitter, model wrapper, and model callback<a class="anchor-link" href="#Base-splitter,-model-wrapper,-and-model-callback"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hf_splitter" class="doc_header"><code>hf_splitter</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hf_splitter</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Splits the huggingface model based on various model architecture conventions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelWrapper" class="doc_header"><code>class</code> <code>HF_BaseModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L28" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelWrapper</code>(<strong><code>hf_model</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <code>HF_baseModelWrapper</code> includes some nifty code for just passing in the things your model needs, as not all transformer architectures require/use the same information.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelCallback" class="doc_header"><code>class</code> <code>HF_BaseModelCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L43" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelCallback</code>() :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use a <code>Callback</code> for handling what is returned from the huggingface model ... "the huggingface model will return a tuple in outputs, with the actual predictions and some additional activations (should we want to use them is some regularization scheme)" - from the fastai <a href="http://dev.fast.ai/tutorial.transformers">Transformer's Tutorial</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_summary_patch" class="doc_header"><code>remove_summary_patch</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_summary_patch</code>()</p>
</blockquote>
<p>This is the ONLY way to get rid of the "@patch" methods we don't want to use!</p>
<p>We do this here because:
    a) we include our own summary methods and
    b) because there is a conflict with huggingface's XMLForSequenceClassification models</p>
<p>This effectively only needs to be called when using models like flaubert, or any other XLM flavored models
(see <a href="https://forums.fast.ai/t/bug-issue-with-patched-summary-method-in-hook-py/74846/8">https://forums.fast.ai/t/bug-issue-with-patched-summary-method-in-hook-py/74846/8</a>)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sequence-classification">Sequence classification<a class="anchor-link" href="#Sequence-classification"> </a></h2><p>Below demonstrates how to setup your <code>blurr</code> pipeline for a sequence classification task (e.g., a model that requires a single text input)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMDB_SAMPLE</span><span class="p">)</span>
<span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;texts.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imdb_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>text</th>
      <th>is_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>negative</td>
      <td>Un-bleeping-believable! Meg Ryan doesn't even look her usual pert lovable self in this, which normally makes me forgive her shallow ticky acting schtick. Hard to believe she was the producer on this dog. Plus Kevin Kline: what kind of suicide trip has his career been on? Whoosh... Banzai!!! Finally this was directed by the guy who did Big Chill? Must be a replay of Jonestown - hollywood style. Wooofff!</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>positive</td>
      <td>This is a extremely well-made film. The acting, script and camera-work are all first-rate. The music is good, too, though it is mostly early in the film, when things are still relatively cheery. There are no really superstars in the cast, though several faces will be familiar. The entire cast does an excellent job with the script.&lt;br /&gt;&lt;br /&gt;But it is hard to watch, because there is no good end to a situation like the one presented. It is now fashionable to blame the British for setting Hindus and Muslims against each other, and then cruelly separating them into two countries. There is som...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>negative</td>
      <td>Every once in a long while a movie will come along that will be so awful that I feel compelled to warn people. If I labor all my days and I can save but one soul from watching this movie, how great will be my joy.&lt;br /&gt;&lt;br /&gt;Where to begin my discussion of pain. For starters, there was a musical montage every five minutes. There was no character development. Every character was a stereotype. We had swearing guy, fat guy who eats donuts, goofy foreign guy, etc. The script felt as if it were being written as the movie was being shot. The production value was so incredibly low that it felt li...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>positive</td>
      <td>Name just says it all. I watched this movie with my dad when it came out and having served in Korea he had great admiration for the man. The disappointing thing about this film is that it only concentrate on a short period of the man's life - interestingly enough the man's entire life would have made such an epic bio-pic that it is staggering to imagine the cost for production.&lt;br /&gt;&lt;br /&gt;Some posters elude to the flawed characteristics about the man, which are cheap shots. The theme of the movie "Duty, Honor, Country" are not just mere words blathered from the lips of a high-brassed offic...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>negative</td>
      <td>This movie succeeds at being one of the most unique movies you've seen. However this comes from the fact that you can't make heads or tails of this mess. It almost seems as a series of challenges set up to determine whether or not you are willing to walk out of the movie and give up the money you just paid. If you don't want to feel slighted you'll sit through this horrible film and develop a real sense of pity for the actors involved, they've all seen better days, but then you realize they actually got paid quite a bit of money to do this and you'll lose pity for them just like you've alr...</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">SequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;roberta-base&quot;</span> <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># single input</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="n">CategoryBlock</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> 
                   <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;is_valid&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Un-bleeping-believable! Meg Ryan doesn't even look her usual pert lovable self in this, which normally makes me forgive her shallow ticky acting schtick. Hard to believe she was the producer on this dog. Plus Kevin Kline: what kind of suicide trip has his career been on? Whoosh... Banzai!!! Finally this was directed by the guy who did Big Chill? Must be a replay of Jonestown - hollywood style. Wooofff!</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>This is the one movie to see if you are to wed or are a married couple. The movie portrais a couple in Italy and deals with such difficult topics as abortion, infidelity, juggling work and family.&lt;br /&gt;&lt;br /&gt;The so called "culture of death" that we are experiencing nowadays in the world is terrible and this movie will surely make you think.&lt;br /&gt;&lt;br /&gt;A must see. I hope it gets distributed as it should.&lt;br /&gt;&lt;br /&gt;Congratulations on the cast and director.&lt;br /&gt;&lt;br /&gt;Two thumbs up and a 10 star evaluation from me!</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training">Training<a class="anchor-link" href="#Training"> </a></h3><p>We'll also add in custom summary methods for blurr learners/models that work with dictionary inputs</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.to_fp16()</code> requires a GPU so had to remove for tests to run on github</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Module.blurr_summary" class="doc_header"><code>Module.blurr_summary</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Module.blurr_summary</code>(<strong>*<code>xb</code></strong>)</p>
</blockquote>
<p>Print a summary of <code>self</code> using <code>xb</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_summary" class="doc_header"><code>Learner.blurr_summary</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_summary</code>()</p>
</blockquote>
<p>Print a summary of the model, optimizer and loss function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have to create our own <code>summary</code> methods above because fastai only works where things are represented by a <em>single tensor</em>.  But in the case of huggingface transformers, a <em>single</em> sequence is represented by <em>multiple tensors</em> (in a dictionary).</p>
<p>The change to make this work is so minor I think that the fastai library can/will hopefully be updated to support this use case.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.blurr_summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.0003019951749593019, lr_steep=0.002511886414140463)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.682027</td>
      <td>0.624071</td>
      <td>0.690000</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.601941</td>
      <td>0.547015</td>
      <td>0.720000</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.491119</td>
      <td>0.510218</td>
      <td>0.790000</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h3><p>And here we creat a @typedispatched impelmentation of <code>Learner.show_results</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>This very funny British comedy shows what might happen if a section of London, in this case Pimlico, were to declare itself independent from the rest of the UK and its laws, taxes &amp; post-war restrictions. Merry mayhem is what would happen.&lt;br /&gt;&lt;br /&gt;The explosion of a wartime bomb leads to the discovery of ancient documents which show that Pimlico was ceded to the Duchy of Burgundy centuries ago, a small historical footnote long since forgotten. To the new Burgundians, however, this is an unexpected opportunity to live as they please, free from any interference from Whitehall.&lt;br /&gt;&lt;br /&gt;Stanley Holloway is excellent as the minor city politician who suddenly finds himself leading one of the world's tiniest nations. Dame Margaret Rutherford is a delight as the history professor who sides with Pimlico. Others in the stand-out cast include Hermione Baddeley, Paul Duplis, Naughton Wayne, Basil Radford &amp; Sir Michael Hordern.&lt;br /&gt;&lt;br /&gt;Welcome to Burgundy!</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The movie and acting are not bad and Jay Hernandez does a good job playing Calito Brigante but the movie forgets it's suppose to be a prequel to a hit movie. The makers of this prequel clearly did not watch the original Carlito's Way or at least did not care about continuity. This movie is a prequel which means the original movie has already laid out some history for us and this movie should end where the original begins or at least lead up to it. Not one of Carlito's close old friends from the original make an appearance in this movie, they're not even mentioned. Luis Guzman, Pachanga in the original, is in the movie but he plays a completely different character. The original takes place in 1975 and the prequel takes place in 1969-70. Considering this movie takes place less than 5 years earlier, wouldn't you think one of Carlito's long time friends would make an appearance? In the original, Carlito start's out being released from jail after spending 5 years in jail. That's only a few month's between the end of the prequel and the start of the original! ***Semi Spoiler*** We know from the beginning of the original, Carlito has spent 5 years in prison so when the prequel gives us this Hollywood happy ending it's an insult to the intelligence of fans of the original. What happen to Gail? It's the lack of continuity that made this film go direct to video release.</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_predict" class="doc_header"><code>Learner.blurr_predict</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L114" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_predict</code>(<strong><code>item</code></strong>, <strong><code>rm_type_tfms</code></strong>=<em><code>None</code></em>, <strong><code>with_input</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as with <code>summary</code>, we need to replace fastai's <code>Learner.predict</code> method with the one above which is able to work with inputs that are represented by multiple tensors included in a dictionary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s1">&#39;I really liked the movie&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;positive&#39;, tensor(1), tensor([0.4562, 0.5438]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.336187</td>
      <td>0.253885</td>
      <td>0.905000</td>
      <td>00:50</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.126690</td>
      <td>0.302692</td>
      <td>0.915000</td>
      <td>00:50</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.111218</td>
      <td>0.296500</td>
      <td>0.910000</td>
      <td>00:50</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXQAAAD4CAYAAAD8Zh1EAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXxU1fn48c+ZySSTfQ9ZScJO2CFsiooLVkTRuuJStbVfa6tVv9oFu9jWLmrbn3aztmr9qq2KFq244YKKS0Ew7EtYAgRIQshG9mWWnN8fM5lMyEKWWcPzfr3y4t5z79w5F8IzZ8495zlKa40QQojgZ/B3BYQQQniGBHQhhBgmJKALIcQwIQFdCCGGCQnoQggxTIT4642TkpJ0Tk6Ov95eCCGC0qZNm6q01sk9HfNbQM/JyaGgoMBfby+EEEFJKXW4t2PS5SKEEMOEBHQhhBgmJKALIcQw4bc+dCGEGCir1UpJSQmtra3+rorXmc1mMjMzMZlM/X6NBHQhRNAoKSkhOjqanJwclFL+ro7XaK2prq6mpKSE3Nzcfr9OulyEEEGjtbWVxMTEYR3MAZRSJCYmDvibiAR0IURQGe7BvMNg7nNYBPS1eyvYU17v72oIIYRfBX1AP1zdxC3/9yW3PiuTlIQQ3lVbW8tf//rXAb/u4osvpra21gs16iroA/qGQzUAVDa0+bkmQojhrreAbrPZ+nzdO++8Q1xcnLeq5RL0o1xarXYALPZ2tNanTf+aEML3li9fzoEDB5g+fTomkwmz2Ux8fDx79uxh3759XH755Rw9epTW1lbuvvtubrvtNqAz1UljYyOLFy9mwYIFrFu3joyMDFatWkV4eLhH6hf0Ab3FYndt1zRZSIwK82NthBC+8os3d7G7zLPPzvLSY/jZpZN6Pf7www+zc+dOtm7dytq1a1myZAk7d+50DS185plnSEhIoKWlhdmzZ3PllVeSmJjY5Rr79+/npZde4qmnnuKaa67h1Vdf5cYbb/RI/YO+y6XV2u7aLqsd/pMNhBCBY86cOV3Gif/pT39i2rRpzJs3j6NHj7J///5ur8nNzWX69OkAzJo1i+LiYo/VJ/hb6NbOFnplYysQ67/KCCF8pq+WtK9ERka6tteuXcuaNWtYv349ERERLFy4sMdx5GFhnb0IRqORlpYWj9VnGLTQ3QK6PBgVQnhRdHQ0DQ0NPR6rq6sjPj6eiIgI9uzZwxdffOHj2g2DFnqr1U5chInaZisV9RLQhRDek5iYyJlnnsnkyZMJDw9nxIgRrmMXXXQRf/vb35g4cSLjx49n3rx5Pq/fsAjoMWZH8poKaaELIbzsxRdf7LE8LCyM1atX93iso588KSmJnTt3usq/973vebRuQR/QW6x2wk1Gwk1GjtXJQ1EhxOlrGPSht2M2GRiVHMnBykZXeXldKxf/8TNKTjT7sXZCCOE7QR/QW6x2zCYjY1KiOFzTjMXmGMb44sYj7D5Wz4sbjvi5hkII4RtBH9DbnAF9dHIU9nbNkZomABpbHVNxI8NCqG22cLxeumOEEMNbUAd0rTXH69sINxlJiXGM7axssABwotnxZ1ObjYv+8Blzf/Oh3+ophBC+ENQPRT8srKC8vpVmq534iFAAap2BvLja0VL/69oDrvPrW62uETFCCDHcBHULvazOMcPqxrkjSYh0BPQaZ0A/VNXU7fwdJXW+q5wQ4rQXFRUFQFlZGVdddVWP5yxcuJCCAs+k/w7qgN7xAHTe6ETiIhwt7xNNFmqaLNQ2W7ud/9RnB31aPyGEAEhPT2flypVef5+gDuhtzoAeajQQFmIkMtTIiWarq3X+j5vzeeu7CwBIjg5j46EatNZ+q68QIrgtX76cxx9/3LX/85//nF/96lecf/75zJw5kylTprBq1apurysuLmby5MkAtLS0sGzZMiZOnMhXv/pVj+ZyCco+9PZ2TUOrzdVCDzU6PpfiIkI50WRh21HHyiBpseHkpcew9YFFrNpaxs/e2EVlQxspMWa/1V0I4SGrl0P5Ds9eM3UKLH6418PXXnst99xzD3fccQcAr7zyCu+99x533XUXMTExVFVVMW/ePJYuXdrr2gxPPPEEERERFBYWsn37dmbOnOmx6gdlC/3/fbCXaQ++T2VjGyajwmBw/MWlxpp5bUspD761G4CkaEe/elxEKLlJjqxoz68/zBNuD0p78sXBas58+CMKimt6PN7ernl9S6nrA0UIcXqYMWMGFRUVlJWVsW3bNuLj40lNTeVHP/oRU6dO5YILLqC0tJTjx4/3eo1PP/3Ulf986tSpTJ061WP1C8oW+uod5QCU1ba4WucA80YlsOnwCdd+gnPkC8C4EdEA/OXjIgBuP2dUr5+g247WUlrbwq3PFbDhR+djNhm7HP9kfyX3vLyV3cfq+dHFEz1zU0KIgemjJe1NV199NStXrqS8vJxrr72WF154gcrKSjZt2oTJZCInJ6fHtLm+EJQt9NAQR7UbWm2ubYAlU9IZEdOZazjELdinxpo5e1yya7++tfc1AJudqyDVtVj5x+eHuh2vdGZ1XFPY+6ewEGJ4uvbaa1mxYgUrV67k6quvpq6ujpSUFEwmEx9//DGHDx/u8/Vnn322K8HXzp072b59u8fqFpQBPczZYq5vsXYJ6HnpMWz40QW9vm56ZufiF33NHG1otREVFkJ+dnyPQfuwczbqsdpW2tvlIasQp5NJkybR0NBARkYGaWlp3HDDDRQUFDBlyhSef/55JkyY0Ofrv/3tb9PY2MjEiRN54IEHmDVrlsfqFpRdLmHOIH6i2UJ4qLHbcZNRERXW/dYyEyJc28frW13dMCerb7USbQ5hZnY8z64rxmJr7/LBcbjakfCrxWrnYFUTY1KihnQ/QojgsmNH58PYpKQk1q9f3+N5jY2OhIE5OTmutLnh4eGsWLHCK/XqVwtdKXWRUmqvUqpIKbW8h+O3KKUqlVJbnT/f9HxVO3UE9OomS5c+9A7bfnYh/11+XrfylOjO7ph7X9nW47X3ljewclMJUWEhTMuMw2Jr55n/HiJn+duu4ZAV9W0kRTn65zcd7vnBqRBC+NopA7pSygg8DiwG8oDrlFJ5PZz6stZ6uvPnaQ/Xs4uOgK41hIZ0b6FHhIYQEdq9hT7SrYVe2dDWZfk6gN1l9XzlD58Cjg+L6SPjAHh49R4Azv39WmqaLNQ0W8jPTiAlOozP9ld55qaEEGKI+tNCnwMUaa0Paq0twArgMu9Wq29hbqNO3LtCTmVUchTv3XM2f1zmWHG7I99Lh/d3l7u2a5ospMeaCT9phMtLG49woslCQlQoC8Ym8d+iKulHF8KHTpfJgYO5z/5EwwzgqNt+ibPsZFcqpbYrpVYqpbJ6upBS6jalVIFSqqCysnLAle0Q5tbNEtZDl0tfxqdGu/q8D1Z2DegVDW2u1r+zvjz3jTksmZLmKjtS3Uxti5X4CBNnj03mRLOVXWX1g7kNIcQAmc1mqqurh31Q11pTXV2N2TywSZCeeij6JvCS1rpNKfUt4DmgWye21vpJ4EmA/Pz8Qf+LuL9wIC30DqOSojAZFVuOnOBit2BdUd9GblIke8obuG7OSADm5CYwJzeBt5e/DcDLBY7PtviIUM4ckwTAp/srmeI2gkYI4R2ZmZmUlJQwlAZhsDCbzWRmZg7oNf0J6KWAe4s701nmorWudtt9GvjtgGoxQBZ75wzNxrbex5P3JjzUyPzRSTz12SE2HKph1R1nsqe8gTWFx1kwJolDD53VbdLR+vvP481tZfzmHUd/eozZRHJ0GHlpMXy8p4LvLBzd60QlIYRnmEwmcnNz/V2NgNWf5u2XwFilVK5SKhRYBrzhfoJSKs1tdylQ6LkqdmdzC+iDXTM0PzsegO0ldZxotvL79/YCUHisvsfAnBYbzq0LRrleZ3SmG7hiZgYFh0/w36Lqbq8RQghfOmVA11rbgDuB93AE6le01ruUUg8qpZY6T7tLKbVLKbUNuAu4xVsVBrDaNTFmx5eLqkbLoK6RlRDu2j5U1Ui083o/uGh8r68xGhQvf2s+f1w2ncumpwNw47xsjAbFFwcloAsh/Ktffeha63eAd04qe8Bt+37gfs9WrWfNFhsHKxvJSYpk+xAWrMiK7xzCeLCyiapGC9Oz4rh29sg+X2c0KC6b3vlM2GwyMjYlil1lsniGEMK/gm7q/7Priil2ztRcMjWN3189bVDXyYjvbKEXHmugvL6V1EGm1c1Lj2GnjHQRQvhZ0AX0aOeU/jZrO49fP5OrZg3sKXCH1Bgz91wwlsTIUDYdruF4XSupsYML6JPTY6lsaKOij/wwQgjhbUGXyyXauchzq81+ijP7ppTingvGYbNrV0rdjpzpAzUpPQaAXWX1sniGEMJvgq+F7nx42WIZWkDvsGxO54jMiWkxg7pGniugSz+6EMJ/gjCgO1voVs8E9Mz4CCakOrIuTkjrOftif+qUkxjBzlLpRxdC+E8Qdrk4qtzqweXf/n37fPYdbyDG+WExGJMyYll/oJqqxjaSosJO/QIhhPCwoGuhd+Q59+R6ntFmE7OyE4Z0jdvPHk1ts4Xn1/e9WokQQnhL0AX0obSivWlKZiyzsuNZsztwlqU7WtPMVx77lJ2l0rcvxOkg6AJ6lDlwe4nmj05iT3m9q3/f3xnhNh0+wd7jDdzx4ma/1kMI4RtBF9A7cqgsHJ98ijN9b9yIKNo1FFU08uj7e8m9/x2/5kqva7ECUD3I9AhCiOASuM3dPmz56SIiwrqvVORvHWuU7q9o4KnPDgFwrL6VjLjwvl7mNZUNbQA0WWxY7e2YBpg7XggRXILyf3h8ZChhPSw952+5SZGEm4xsO1pHsnP90kMnLaLhSx0BXWsoq23xWz2EEL4RlAE9UJmMBqZlxbLp8AnXItIHqxr9Vp/KxjbX9smrMwkhhh8J6B521thkdpTWccAZQAuKT/itLpUNbcxy5m+XWaxCDH8S0D3s5jNyMBmV64Hkx3srsPvwwWjhsXrOfPgjqhrbqGxoY1RSJDmJEWwvqWPV1lKPzbAVQgQeCegeFhUWwujkKNd+Q6uNozWDW1VpMP7x+SFKa1t4b1c51U1tjmXy0mN4f/dx7l6xlf99eavP6iKE8C0J6F6Q50zy1ZEj5sM9FT5774RIR999cVUTVrsmOTqsywfM6p3lPquLEMK3JKB7wdTMWADXSJdfvrWbUh+NMokIdYz+2VPeAEBSVBhjUqK6nOPJtAlCiMAhAd0LzhiTBEBjm42fLJkIwMqCEp+8d7MzrfCmw46HsUlRYd3SAh8d5MLaQojAFpQTiwLd2JQo7jp/LEumpDE+NZoXNhxh73HfpNZtaHU8jO0I7LlJkYyI6Zr98UBFY5duGCHE8CAtdC9QSnHvonGMd/ah5yRGcKjKN63ihlZbl/0RMWEopfjjsuk8cEkeJqNi85Fan9RFCOFbEtB9IDsxksJj9Xyyr9Lr79XQaiMnMcK1r5Qj981l0zP4xoJcpmTE8mVxjdfrIYTwPQnoPnDG6EQAnltX7PX3ami1khkfwfPfmMNr3zmj2/HZuQlsL6mV8ehCDEMS0H3gwkmpLJmSRlGF99MANLbZiAoL4exxycwcGd/t+JycBKx2zeYj/pvBKoTwDgnoPjIxLZojNc2uh5be0tRmJzKs92fdc3ITCDcZeW1zqVfrIYTwPQnoPpKX7hg62DE+3FtarHbXWPSeRJtNXDs7i5WbSvjiYLVX6yKE8C0J6D7SMRZ8XVG1V/uvmy22PgM6wPLFE4gMNfLChiNeq4cQwvckoPtIaoyZ2HATj63Zx7f+uckr79Hermm1thN+ioBuNhmZNyqRN7eV8fb2Y16pixDC9ySg+4hSypXj5ZN9lV7JwNjibPmfqoUO8MCleQDc8eJm3thW5vG6CCF8TwK6D/32qqmu5ej2Hfd8X3rH7NDw0FNPAM5OjHRt3/XSFqx2ye8iRLCTgO5DWQkR/OOWfAD2euHhaIszoEeY+rc839WzMl3bh6tlRSMhgp0EdB8blRRFiEF5ZbRLs9Ux7b8/XS4Av7liCitumwfAvuP+WypPCOEZ/QroSqmLlFJ7lVJFSqnlfZx3pVJKK6XyPVfF4SU0xMCUzFjWFB5Ha8/2o3d2ufQvoJuMBqZnxaGUd74xCCF865QBXSllBB4HFgN5wHVKqbwezosG7gY2eLqSw801+VkUVTR6vFXs6nLpRx96B7PJSHZCBPsrJKALEez600KfAxRprQ9qrS3ACuCyHs77JfAI0OrB+g1Lk9MdC2Cs2lpKzvK3OVzdxP2vbefuFVuGdN1mS/9HubgbNyJaWuhCDAP9CegZwFG3/RJnmYtSaiaQpbV+u68LKaVuU0oVKKUKKiu9n3kwUOUkObIh/nXtAQDe3nGMlzYeZdXWMmxDGG1S22wBBh7Qx6dGU1zdTJtNEnYJEcyG/FBUKWUAHgXuO9W5Wusntdb5Wuv85OTkob510Io2m0iKCnXtl57oXJ6u8NjgW8pr91WSFBXaZUhif4wdEY29XXOwUka6CBHM+hPQS4Est/1MZ1mHaGAysFYpVQzMA96QB6N9m5DauSxcQXFn5sPC8sGvbLT1SC1njknCaFADet34EY6FOLwxNl4I4Tv9CehfAmOVUrlKqVBgGfBGx0GtdZ3WOklrnaO1zgG+AJZqrQu8UuNhYlpWrGt7r1sgPVA5+AelTRYbceGmAb8uNymSEIOSgC5EkDtlQNda24A7gfeAQuAVrfUupdSDSqml3q7gcDUtM65bWbjJyIGKwXd7NLfZiegjdW5vQkMM5CZFsrdcxqILEcz69b9fa/0O8M5JZQ/0cu7CoVdr+HPvcumQnxM/6Ba6xdaOxd5O5AAfiHYYlxrNf4uqaLPZCQsZ3DWEEP4lM0X9JDM+vFvZ9Kw4jtQMfLRJq9XuWq90IGPQ3Z0zNpnaZisPvbOnS7nWmqrGtkFdUwjhWxLQ/cRgUIxKimROboKrbExKFPZ2zZHq5gFd65F39/A/zzseWUSGDa51fc3sLK6cmcmLG450ydf+/u7jnPHQR1TUy/QCIQKdBHQ/+uh7C3nZmUsFYHRyFMCA1x49WtM57HGwLXSACyamYLG3d5lkdKS6GYu9nV1lgx99I4TwDQnofqZU5xDDUcmO8eMD7UdPiQlzbUcN4qFoh0nOGazuwbuuxbEG6l4ZASNEwBv8/37hMZ//8FyMBkVEaAgZceEcGOAEH4utc3bpQGeJustKCCfaHMLOsjpXWUdAlyGNQgQ+CegBIDM+wrU9KjlywF0uHUEXIHIILXSlFJPSY3psoe+X9LpCBDzpcgkwo5OjOFDZOKDUunXNnQFdDWySaDeT0mPZc6zelVOmI6AXVTTS7oVl84QQniMBPcCMSYmi2WKnfACjSuparGTGh3POuGTXg9XBmpQeQ5utnYNVTa5rg2O90hK3nDNCiMAjAT3ADGakS22LhTNGJ/LcN+Zg7ufyc73peDC65Ygjv0x9i9Wr66AKITxHAnqAGZ/qSJRVeKx/wwTb2zU1TRYSo8JOfXI/jE6OJDbcxEOr99DUZqO8vpV5oxIB+ObzBewoqTvFFYQQ/iIBPcAkRIaSFmtmze6KfvWj17VYsdo1yR4K6CFGA9+7cBy1zVbe3nGMZoudM0Ynuo4/8u6ePl4thPAnCegBaEJqNBuLa1hTWHHKc/+zxZHJODnaMwEdYOH4FABe/tKxrsm0rFje+u4CzhyTyK6yOo+vhSqE8AwJ6AHooSumAlBQXMOxuha2l9T2eu6Db+0GPBvQM+Md49E3O/vRM+MjmJwRy0WTUjnRbOVYnaQBECIQSUAPQKmxZqZmxrKjtI4/fLCfm57ZeMpWcZKHulzAMR49Ly0GrSEy1Oh60JqX7sgQuVvSAAgRkCSgB6gpGY6AXlbXQm2ztcchg1a39UfT48weff+O0S7uD1snpMagFJLXRYgAJQE9QE3JiKWh1cZn+6sA2FXWfXRJizMr4k+WTBxSUq6eTHK2xhPd1j6NDAshNzGSHaV1VDa08fX/2yhZGIUIIBLQA9T0kV1XNOqpVdxqcQT0oY4978mkDGdAjwztUj47J4ENh6r51xeH+XhvJU9/fsjj7y2EGBwJ6AFqQmoMC8cnu/Z7DOhWR5eLNwL66OQoQkMM3frmF4xNoqHVxsd7HSNwTjRZPP7eQojBkeRcAeya/CzW7nWsRNRXl0u4FwK6yWjgL9fNYNRJqQTOnZCC2WRgu3OC0ZfFNWitu6QBFkL4h7TQA1jHakZnjknkeH1bt6XgXAE91Dv/jBdOSmVMSteAHhUWwoIxSa794urmAWeHFEJ4hwT0AJYUFUbxw0u489yxQPdul46l4sw+XtR5RIxjRM11c0YC8HlRlU/fXwjRMwnoQWBSRgwG5Zho5K6jhW4ewqIWg3HFzAwAbpw3kqyEcL44WO3T9xdC9EwCehCIMZvIz0ngg93Hu5S3ebEPvS+zshMofngJk9JjmT8qkQ2HaiRXuhABQAJ6kFgwJom9xxtobLO5ylwtdB8HdHfzRiVS22yVNUeFCAAS0IPEpHTHVPw9bml1WyyOYYu+bqG7m+tMrSvdLkL4nwT0IOHKo+IW0F0PRU3++2fMiAtnZEIE6w5UUyNj0oXwKwnoQSI1xkx8hKlLYqxA6HIBuGDiCD7YfZyZv/yAFzYcRmstfepC+IEE9CChlCIvPaZbC10pCAvx7z/j7eeMcm0/v+4w972yjSV//tyPNRLi9CQBPYhMSo9lT3kDFpuj77zVasccYvT7LM2UGDMdVdh7vIHXtpRSeKyeigZJ3CWEL0lADyIzsuKw2NpdaQBarHbCfTwGvTfrlp/Ht9xa6gDbj8r6o0L4kgT0IDIzOx6AzUccKxi1Wtv9OsLFXVpsONc7Z4522NbHSktCCM+TgB5ERsSYyYgLZ/Nhx9JwLVY7YX4c4XKy7MRIbpw3kgVjkpiYFsPWoxLQhfClfkUDpdRFSqm9SqkipdTyHo7frpTaoZTaqpT6XCmV5/mqCoBZ2fGutT5bLfaAaaF3+NXlU/jXN+cyY2Qcn+2v4r5Xtvm7SqcvWcz7tHPK9LlKKSPwOLAIKAG+VEq9obXe7Xbai1rrvznPXwo8Clzkhfqe9maOjOONbWW8trmEVpvd70MWe3Pj3Gxe3HCEVzeX8OMlE0k4aaEM4WFNVXBsKxzb1vlzohiUEYyhjp8Q559GExjDOrdDwpxloc7yXsqMoSeVh/ZwbfeyfpxrCAFJvewx/cmHPgco0lofBFBKrQAuA1wBXWvtngYwEpCmgZfMynak1L33lW3kJEaQGR/h5xr1LC89hkeunMIPX93BtqO1nDshxd9VGh60hobyroH72FaoL+08Jz4H0qbDlKsd59stYLeCva1z29bmLLM4y63Q1ti9zG4Bm8VZZgFt9/ANqVN8KPRQ5vrAcf9w6qmsj3O7fOCc4twg+sDpT0DPAI667ZcAc08+SSl1B3AvEAqc19OFlFK3AbcBjBw5sqdTxClMSIt2bRdXNzMmJbqPs/3rkqnp3P/aDrZKQB8craHuqCNol7m1vpsqnCcoSBoL2WdA2jTHT+oUCI/3Xp3a7c4g38MHwsnBv+NnIOf2eg0LWOtOKu/4YHIra7ed+h4GytDXN5bQPsp6+3AywZhFkD7d41X12IpFWuvHgceVUtcDPwFu7uGcJ4EnAfLz86UVPwgmo4GiXy9m7m8+pLrJ4tdp/6cSGRbCuBHR8nC0P9rb4cSh7t0mLY7nJSgjJE+AMRc4AkHaNBgxGcKi+r6upxmMYAgHU7hv37e/2tu7Bvxu30pOKrf199xeXu/+bcfSBPaa3r8BddQLICLJbwG9FMhy2890lvVmBfDEUCol+hZiNHD93JH8+aMiWiye/grsWdMy43hvd7ksU+eu3Q5V+7sG7vLt0ObsuTSGQkoeTFzqbHlPhxF5gRtEA4nBAAYzmMz+rknPtHYEdy/9X+hPQP8SGKuUysURyJcB17ufoJQaq7Xe79xdAuxHeNXC8cn8+aMidpQG9uSdWTnxvFxwlP0VjYwbEbjdQ15jt0Llnq5dJsd3grXZcTwkHFInw9RrOrtNkic6vp6L4Ucpr/7bnjKga61tSqk7gfcAI/CM1nqXUupBoEBr/QZwp1LqAsAKnKCH7hbhWVMy4gCYPzrRzzXp27zczvS6wz6gW1uhYlfXlvfxXZ1fs0OjIHUqzLy5s9skcSwYZa124RlK+2msan5+vi4oKPDLew8XFfWtxISbAnboIoDWmjMf/ogZI+N5/IaZ/q6O51iaoHxn1+BdWdj5UM4c19ni7ug2SRjl6BIQYgiUUpu01vk9HZOmQRBLiQnQfkI3Sinmjkrks/2VwduP3loH5Tu6jjap3g/akSTN9YBr3IWdATwuO6iGu4nhQQK68Lq5uQn8Z0spB6uaGJ3s41EZA9Vc032kSc3BzuPR6Y6APemrjj/Tp0N0mgRvERAkoAuvm5PrmAy14WBNYAX0huNdJ+cc2w51RzqPx410BO3pNzi6TNKmQpSMpxeBSwK68LrcpEiSosLYeKia6+f6YUKZ1o6ZlB3Bu6PbpLG885zEMZA1G+Z80zlBZypEJPi+rkIMgQR04XVKKebmJrDhUA1aa744WMOP/rODp27KZ0yKh1vsWjtymJzcbdLsXMRaGSBpPIxa2NllMmIymGM8Ww8h/EACuvCJBWOTeHvHMXaW1rPhUDWHqpp4eHUhT988e/AXbbdD9QG3LpNtjm6TNufYfEMIpEyE8Re7TdCZBKGBmf9GiKGSgC584uIpafxs1S7e3F7mWgN169Ha/o98sdugau9JSam2g7XJcdwY5pigM+XKzpEmKXmOHBxCnCYkoAufiA03MX1kHOsPVDPLufJSVaOFoopGxp484cjWBhW7u0/QsTnXKDVFOpJQzbjRbXbleEfSIyFOYxLQhc/MG5XIXz7aT1ps5/j5Jz/cye/OCuna511RCO1WxwlhMY6APfubzpEm0yBxtCNJlBCiCwnowmfOyAxlPXsYuf9dnoouYZR1Pzl7S2Cfc7ZyeILjIeUZd7pN0MmR2ZVC9JMEdOEdLSccfdxuLe+51Qf4d5gjeNfYEwjLnsFfDuSTN/MsFp13IcRmygQdIULcQ18AAB0iSURBVIZAAroYusbKk0aabIPaw53HY7MgbRpq6jJ+s9XEf44lMXXCeP5xy2zefPQTPjoWwgWxmcGZFkCIACIBXQzNi8tg3+rO/YRRkDET8r/unKAzDSI7M0KGte2l8lgRDW2OJFY3n5HDT1/fyc7SeqZkxvq69kIMKxLQxdBMvBRyFrgtfxbX5+nX5Gfx54+KSHc+GL14cioPrNrJx3srJKALMUQS0MXQzLhhQKdnJUTwyfcXEh/pSPKfGBXG1Mw4Pt5bwV3nj/VGDYU4bcjwAeFz2YmRxJg7x4wvHJfMliO1nPXbj3h9S1+rGwoh+iIBXfjduRMcGQyP1rTwszd24a9FV4QIdhLQhd9NzejsO69rsXK4utmPtREieElAF35nMCj+detcHrt2GgCfFVX5uUZCBCcJ6CIgLBibxOXTM8iIC+fz/ZU9nqO17tYds+lwDT9cuZ32dummEUICuggYSikWjEli3YFqbPb2bsd/9sYuLvrDZ2itqWuxorVmTWEFLxccZXtpnR9qLERgkYAuAsqCsUk0tNrYVlLrKiuvayVn+ds8v/4we4838JePipj2i/d5dl0xtc0WAD4qPO6vKgsRMCSgi4By9rhkAK58Yj17yxsA+PykPvVH1+wD4LXNpdQ0OQL6h3sqfFhLIQKTBHQRUGLDTSyZkgbAqq2OMembDp9wHT93fDId3eg7SuvYdNjRkt9VVk95XatvKytEgJGALgLOX66fwbxRCXzkbHWX17WQERfOJ99fyLI5jkWmr5qVSWiIgarGNkYlRwLw4R7pdhGnNwnoIuAopThvQgp7yhvYcuQENc1WRiVHkp0YyXkTUrhh7khuXZDLfYvGARAfEcqopEiZZSpOexLQRUBaPDmNyFAjN/1jI9uO1hIf4cj9YjIa+PVXpzAxLYal09MBCAsxsGxOFl8Wn2D/8QZ/VlsIv5KALgJSVkIEb991Fk0WR5rdBGcyL3dpseE8+bVZPHrNdK6cmYnJqHil4KivqypEwJCALgJWTlIk07Ic6Xg7Wugnu3BSKqmxZhKjwjhzTBLv7z4uuWDEaUsCughos0bGA9Bqs5/y3AsmjuBwdTN7yhsoKK7xdtWECDgS0EVAu3xGBgCT0mNOee75Ex1ZG5f86TOu+tt6Nh85cYpXCDG8SEAXAW1yRizbHrjQNTa9L2mx4czOiacjrct7u8q9XDshAku/ArpS6iKl1F6lVJFSankPx+9VSu1WSm1XSn2olMr2fFXF6So2wtTvBaTvXTSezPhwAF7ccISGVqs3qyZEQDllQFdKGYHHgcVAHnCdUirvpNO2APla66nASuC3nq6oEP0xf3Qin//wPF799nwaWm18sNt3k40qGloZ++N3eHenfDMQ/tGfFvocoEhrfVBrbQFWAJe5n6C1/lhr3bEqwRdApmerKcTAzMiKJy3WzDs7fBdci6uasdo1t/9rk8/e09tarXaOyIIjQaM/AT0DcB/cW+Is682twOqeDiilblNKFSilCiore855LYQnGAyKxZPT+HR/pUe7XcpqW6hr7vl6LdbOkTiFx+o99p7+9Pz6YhY99okrCZoIbB59KKqUuhHIB37X03Gt9ZNa63ytdX5ycrIn31qIbpZMTcVia+fDQs9lYrzm7+uZ9uD7lJxwtFrf2XGM1TuOAdDcZnOdt/iPn1Fc1eSx9/WX6kYLbbZ2ecAcJPoT0EuBLLf9TGdZF0qpC4AfA0u11m2eqZ4QgzcjK57UGDNvbivz2DVLTrQAsOCRj9l3vIHvvLCZb7+wGau9nUZnQD9rbBIAT3120GPv6y8d3zre2l7Gkepm/rBmH3ZZHSpg9SegfwmMVUrlKqVCgWXAG+4nKKVmAH/HEcwlMbUICAaD4vIZGazdV0lFvWdS64aGdP6XeXVTiWv7hS8O0+QM6I9dO52vzsjgtc2lrpZ8sGq2OAL6+gPVPPLuHv6wZj8bDlb7uVaiN6cM6FprG3An8B5QCLyitd6llHpQKbXUedrvgCjg30qprUqpN3q5nBA+de3sLOztmpWbS0598im02exYbO3ct2gc509I4VW3a/7l4yJqWxx961FhIXzvK+NRCn7y+s6gTkXQYrUTFmKgXcPbzq6l1ySrZcDqVx+61vodrfU4rfVorfWvnWUPaK3fcG5foLUeobWe7vxZ2vcVhfCN3KRI5uQm8MqXR4ccWJvaHK3VaHMIX52ZQVWj40HhRZNSqWq0sGprGSEGRViIgYy4cL7/lfGs3VvJ6iAexthqsTM6OYoxKVGAI0na6h3HaLGcOhWD8D2ZKSqGvWWzsyiububPHxWx/3gDn+yrHFTu9I4ulSizicWTO2euXjEzg4y4cA5VNRERanRNgrppfg5jU6L4w5p9tJ/U72yzt3usG8ibWqx2IkKNXD49nVCjgQcvm0STxc7qncf8XTXRAwnoYti7dFo6E1KjefSDfSx67FNufmYj97y8tdfhhz05WtPMIeeolaiwEIwGxeq7z2JObgIzs+O5YZ5jJaX61s6RLkaD4s7zxrDveCPvnjRK5Im1B5jzmw8Dvo+9xWonPNTIt84ZzQf3ns2SKWnkJEZImuIAJQFdDHsmo4E/LJverfzJzw70+xpXPrGOm57ZCDgCOsDEtBhe+dZ8kqLCuG72yB5fd8nUdEYlR/KnD/e7Wukf7TnO//vAsdD1P9cfHtC9+FqLxU64yYjJaCA7MRKlFFfnZ/HFwRqKKmQxkUAjAV2cFiakxrDrF1/pUvb8usO0WvvXF1zR0DkSN8oc0u14fGQoP7hoPHedN6ZLudGg+O55Y9hT3sAHhY40BH9b2zmc8e+fHuTlL4/0+z68oa7ZyrE6x3DMnaV1XUbvdLTQ3S2bnYXZZODJT4N/WOZwIwFdnDYiw0K4Ya6jJf2dhaNpaLNx94ot/Qrq7sMVI04KcB2+s3AM9144vlv5pVPTGZkQwRNrD6C1di1q/euvTmbGyDgefHM3J9xmYt710ha++dyXXa6xq6yO/xZVnfomB+HOlzYz/6GPWHegikv+/Dn3/XubK8B3tNDdJUaFcU1+Fv/ZUsrxIHgOcDqRgC5OK7+6fDIf3ncO37twPKOSI3lv13H+/knfLU2tNRZbO0unpXNNfia5SZEDes8Qo4H/OXsUW4/W8un+KmqbrYxNieKGudk8fMVUmix2Zv96DbXNjqD+xrYy1hRW8PM3drmuceUT67jh6Q3UeyF75IGKRgCuf2qDq+y1zY6Hxi1WO2ZT9w+w/zlrFPZ2zV0v9e8DUfiGBHRxWlFKMTo5CoNB8ewtcwgLMbDiyyPY7O29vsbiPDY+NZrfXjUNk3Hg/22unpXJyIQI7nxxM5uPnCDeuUbq+NRors3Pwtau+eVbhV1Gw7y44YgryCscI2fufXkb1j7qOhjpceHdyl7ccIQtR07Q0GojzNT9frMSIrjr/LFsOFTD29tlxEugkIAuTlsjEyP447LpHKtr5eO9vSeLa7M5AmhYyOD/u5hNRl78n7mAoz8+PsLkOvbIVVO5alYmr24u4d+bHKNHLp6SisXe7hpe2ZHjfU3hcZ738IPUJoudubkJXDBxBE/cMJN/3jqHsroWrv37FwDkJvb8jeTu88eSmxTJPz4/xMHKRi587BN2ldV5tG5iYCSgi9Pa+RNHMCImjH9+0XuQbLMOPaADZMZHcOM8x9ovjW6JvAB+e+VU8tJieGj1HgDOGJ3ElIxYXilwPKCsa7GybHYWc3ISeObzQ31+oxiopjYbabFmnr45n8VT0jhrbDLnjEvGYm9nVnY8187O6vF1SinuPn8su4/Vc91TX7DveCNf+8dGj9ZNDIwEdHFaMxkN3DA3m0/3VXKwsrHHczq6XMJCen4YOhA3z88BID22azeHwaD42vxsap1j4xMjQ7kmP5Pdx+rZerSWuhYrseEm/ufsUZTWtnh09mlTm43IsK4jd77m/OCZkhHb52pRS6elMys7nuP1jlFANU0W3tzuuWRoYmAkoIvT3rI5WZiMqtdWepvzoV9PfckDlRprZs29Z/OzpZO6Hbt0WrprOz4ylMtnZBAXYeL+13bQZmsnJtzE+RNSGJUUyd8/PeCxHDGNbTbX2PoOC8encNP8bK6Y2dfSB44Pohe+6ehKCjUaGJUcyf/9tzio89cEMwno4rSXEm3m4ilprCwocU3vd9fRhx46iIehPRmTEt0tgIJjwtKfr5vBueOTyUuPIdps4peXTXYtlhEbbsJgUHzn3DHsLK33yFJ3Nns7bbb2bi10o0Hx4GWTmZoZd8prmE1G1tx7Dh/cezZfPyOH7SV1bD5SO+S6iYGTgC4EjrwrDW22HjMJuh6KeqCFfiqXTkvn/74+hxizybWf4RyFEhPuKPvqjAxGJkTw7LriIb2X1tqVcOzkgD5QY1KiyE6M5IqZmUSbQ/jbJ577BiH6TwK6EMDMkXFMyYjluXXduwssNs/1oQ/Ga985g5vmZzN/VCLgaD1fP3ckGw7VsP/44KbfH61pJvf+d3h9q+MDLLKXyVIDFRkWwu3njOaD3cd5caN/Z8CejiSgC4FjxMbXz8yhqKKRz0+akdlmc/ahD3GUy2CNiDHz4GWTSY4Oc5Vdk59FRKiRX71dOKhrHnA+AP6Zc/JST+kMBuvb54xmwZgkHn5nD3Utnp8IJXonAV0IpyVT00iKCuXZ/xZ3Ke8Ythjqp4Dek4TIUO5dNI5P9lWybhApAWz2rt9CZo6M91TVMBgUyxdPoKHNxvND7BYSAxM4v6FC+FlYiJHr52bz0d4K1wLPRRUNrlasv7pcenPjvGxSY8z8vw/2Dbi/usniePg7KimSaZmxPc4WHYrJGbGcPyGFv3xcxI4SmWzkKxLQhXBz49yRhBiU64HjI+/upbTWkajKX10uvTGbjNxx3hg2HT7BQ6v39CvPS0fg71hx6Plb5/Cf75zplfr97uppRIWF8Nv39njl+qK7wPoNFcLPUmLMLJmSxrPrinltc4nrgSj4ZpTLQF2bn0VuUiRPfnqQ5a9u7/Pc7760hfv+vQ1wTPcHx1BJg6H3iUNDkRAZyrfOGcVn+6vYdLjGK+8hugq831Ah/OznSycxJiWK37+3l93OMeDgGAceaEJDDPzz1jlkJ0bwzo7yPrs3Co/V89rmUvaU19Pi7HKJCPXcw9Ce3Dgvm8TIUB77YL9X3+dkR6qb+fsnB7ot/TfcSUAX4iRxEaH8+OKJlNW1UtnQxk+WTGTfrxZ7PfgNVmZ8BG9+dwHxESYeWl2IvZcg1uycNPX4xwdostgxGZXXH/RGhIbw7YWj+byoymv53Hvy9o5jPLR6D++cZmufSkAXogcLxye7tufkJgTUCJeexJhN3LtoHOsOVHPdk1/0OD69I4i/tb2MnaV13Rau8JYb52WTERfOI+/u8dlko46ust+9t9fj6YYDWWD/lgrhJ0opnvvGHM6bkEJeWoy/q9MvX5ufw2+vmsruY/Xc9MzGbkG92WLjqzMyCAsx8Nn+qiHPDu0vs8nI3ReMZXtJHWsKK7C3ay549BNe2ODIndPerl153z2lI4gfrm7mpdNogpMEdCF6cc64ZJ65ZTYhHsrh4gvX5Gfx1E35HKtrZdFjn7K9xJFTxWJrx2rXZMVHcN0cxzJ8J68V6k1XzMggOzGCB1btZP2BaooqGvnde3tpaLXy+tZSpj/4Ab99d0+v3UUDZbW3ExZiYN6oBP704f5u6Yo9rbyulftf2+6VFaUGInh+U4UQ/TJ/dCLfODMXgJ++vhOrvd01TDEiLIRvnT2aUKOBSB8+EwgxGnjoiinUt1i5e8UWAGqbrTz92SFX8rG/rj3A91du88j7WezthIYYWL54IlWNFq8vaL1qaykvbTzKbwY5c9dTJKALMQw9cGkef71hJttK6nj0g32uiUSRoUZSY80sXzzhlKlxPe2M0Un85JI8qp0LYk/OiOEfnx9iZ2k90WEhjB8RzWubS/lkX++rR/WX1d5OqNHA9Kw4LpmaxpOfHnDNJ/CGWmeKgxVfHuUe5weWP0hAF2KYunhKGtfNyeJvnxxg/YFqwNFCB/jGgly+7mzF+9I1+VnkpcWgFDxy5VSaLTbWH6xmSmYsq+48k9HJkdz3yjZONA2tT91q0661X++/eCJaw8OrvTfB6Uh1MyajYzz/61vL+M+Wkm7n+GIlJwnoQgxjP16SR2JkKPe/tgOACB+NbOmN0aD48/Uz+N1V05iUHstPL8kDoNlix2wy8ufrZlLT1MbjHxcN6X2s9nZMIY4AmxEXzu3njObNbWVsPOTZCU6VDW38dW0RByobmT86icIHL2L+qETufWUbXxysdp1X1djGtF+8z6qt3dMze5IEdCGGsaiwEL7/lfGuZfQiwvyfj2Z0chRXzcoE4JYzcrhv0ThXYM9Lj+HqWVk8v/7woFMDg6MP3eT2MPv2c0aTHmvmgVU7PTqMceWmEn777l72lDcwOT2G8FAjz9wym7QYM8ue/MIV1PeVN9BksfOrtwu9+oBWAroQw9w1+VmuRTLMfm6hn0wpxXfPH8us7M5sj/d9ZRzR5hC+t3L7oGd6dvShdwgPNfKzpZPYU97Arc8VeCxhmPuHw5ljklzv9b+LxgGw7MkvqKhv5eiJZsDRoh/qt4++SEAXYphTSvHGnWdy9/ljmZIR6+/qnFJKtJn7L57ItqO1rgU4Bspq111a6ABfmZTKueOT+XRfJZf+5XPqmoc+xLDG2df/w4smMDc3wVV+1axMHr1mGkaD4gevbqeoohGjQXH59HRe3VRCq3OdWk+TgC7EaSAxKoz/XTSuW5ALVFfMyGBqZiyPvDu4RTKs9nbXQ0p3j1w1lUV5IwD4/ft7h1zP6iYLOYkRfHvh6C7zFZRSXDEzkwcuyWPt3kqe+uwQWfHhPHDpJN7/37O99k2pX/+6SqmLlFJ7lVJFSqnlPRw/Wym1WSllU0pd5flqCiFOJwaD4udLJ1HTZOHOFzcPOGWAxdbe44dXSrSZp27K55YzcvjXhsNsOXJiSPWsbmwjMSqs1+M3zc/mjNGJjIgJ44/LZpAQGUpcROiQ3rMvpwzoSikj8DiwGMgDrlNK5Z102hHgFuBFT1dQCHF6mjkynp9eksdn+6v45xeHsdjaqW5s69drrc6JRb2598JxpMWYue+Vba5JV4NR02QhIbL3AN2RQmLt985lWlbcoN+nv/rTQp8DFGmtD2qtLcAK4DL3E7TWxVrr7cDpkwVHCOF1N87N5tzxyTywahfjfrKaWb9awz0rtrj6rnvTUx+6uxizid9dPY2DVU088m7X8emtVjvffK6AguJTD3GsamwjKarvFrfJaPBZmoX+BPQM4KjbfomzbMCUUrcppQqUUgWVlUOfDSaEGN4MBsWj10x37V8wcQSvby3jByu399kN01sfurszxyRxyxk5PLuumOfXF7tGrByobGRN4XHuXrG1zyGGFls7VY0WUmM8u3zfUPj0CYnW+kmtdb7WOj85OfnULxBCnPbiI0P57AfnsvZ7C3n65nx+fPFE1hQe52Fny9pqb+fmZzby/q5y12tOHofem+WLJ3D+hBQeWLWLsT9ezStfHqWsthWA0toWfv327h5f90rBUdYUHgcgNbb3PnRf6092nlIgy20/01kmhBA+kZUQ4dr+xoJcDlQ28vdPDjIlI5axKdF8sq+SjYdq+M8dZzAhNabbOPTemE1GHr9hJr9/by9Pf36In6zaydJp6QBcPSuTlzYeZWpmnCtDJTjWZf3J6ztdmSFHxJg9fLeD158W+pfAWKVUrlIqFFgGvOHdagkhRM+MBsUvL5/M9Kw47nxxC1/5w6cAKAXffK6AY3UtXXK5nIrZZOQnl+Sx+aeLSIoMZeWmEowGxW+umMLZ45L56es7WXegc7Wl6iYLFlu7K6CnxgZRQNda24A7gfeAQuAVrfUupdSDSqmlAEqp2UqpEuBq4O9KqV3erLQQ4vRmMhp48muzOGtskqvs2a/PobbZyu3/3ERTm82Vy6W/EiJDefyGmYSFGDhrbBImo4G/XD+DnKRIrn9qA9N+8T6XP/5fXt/i6KD42rxsFoxJIicx0qP3NhTKV0tCnSw/P18XFBT45b2FEMPHy18eYUdpHb+6fArv7jzG7f/aDMDXz8zhZ5dOGvD1rCf1vx+taebOFzezv6KRZrchjm99dwGT/TDzVim1SWud39OxwFz1Vggh+una2SO5drZj+6LJaXxzQS5Pf35oUDNMgW5dNVkJEay6cwGNbTY2HT7Bzc9sBHDlxwkkEtCFEMPK8sUTiAg1sigv1aPXjQoL4ZxxyWx9YBG7yuqJ72NCkb9IQBdCDCshRgP3Xjjea9ePiwh1ZVYMNMGRqUcIIcQpSUAXQohhQgK6EEIMExLQhRBimJCALoQQw4QEdCGEGCYkoAshxDAhAV0IIYYJv+VyUUpVAocH+LIkoOqUZwUHuZfAJPcSuIbT/QzlXrK11j0uKOG3gD4YSqmC3pLSBBu5l8Ak9xK4htP9eOtepMtFCCGGCQnoQggxTARbQH/S3xXwILmXwCT3EriG0/145V6Cqg9dCCFE74KthS6EEKIXEtCFEGKYCIqArpS6SCm1VylVpJRa7u/69IdS6hmlVIVSaqdbWYJS6gOl1H7nn/HOcqWU+pPz/rYrpWb6r+ZdKaWylFIfK6V2K6V2KaXudpYH3b0AKKXMSqmNSqltzvv5hbM8Vym1wVnvl5VSoc7yMOd+kfN4jj/rfzKllFEptUUp9ZZzPyjvA0ApVayU2qGU2qqUKnCWBevvWZxSaqVSao9SqlApNd8X9xLwAV0pZQQeBxYDecB1Sqk8/9aqX54FLjqpbDnwodZ6LPChcx8c9zbW+XMb8ISP6tgfNuA+rXUeMA+4w/n3H4z3AtAGnKe1ngZMBy5SSs0DHgEe01qPAU4AtzrPvxU44Sx/zHleILkbKHTbD9b76HCu1nq62xjtYP09+yPwrtZ6AjANx7+R9+9Fax3QP8B84D23/fuB+/1dr37WPQfY6ba/F0hzbqcBe53bfweu6+m8QPsBVgGLhsm9RACbgbk4Zu2FnPw7B7wHzHduhzjPU/6uu7M+mc7AcB7wFqCC8T7c7qcYSDqpLOh+z4BY4NDJf7++uJeAb6EDGcBRt/0SZ1kwGqG1PubcLgdGOLeD4h6dX9NnABsI4ntxdlNsBSqAD4ADQK3W2uY8xb3OrvtxHq8DEn1b4179AfgB0O7cTyQ476ODBt5XSm1SSt3mLAvG37NcoBL4P2d32NNKqUh8cC/BENCHJe34KA6aMaNKqSjgVeAerXW9+7FguxettV1rPR1HC3cOMMHPVRowpdQlQIXWepO/6+JBC7TWM3F0QdyhlDrb/WAQ/Z6FADOBJ7TWM4AmOrtXAO/dSzAE9FIgy20/01kWjI4rpdIAnH9WOMsD+h6VUiYcwfwFrfVrzuKgvBd3Wuta4GMcXRNxSqkQ5yH3Orvux3k8Fqj2cVV7ciawVClVDKzA0e3yR4LvPly01qXOPyuA/+D4sA3G37MSoERrvcG5vxJHgPf6vQRDQP8SGOt8eh8KLAPe8HOdBusN4Gbn9s04+qM7ym9yPu2eB9S5fTXzK6WUAv4BFGqtH3U7FHT3AqCUSlZKxTm3w3E8DyjEEdivcp528v103OdVwEfO1pVfaa3v11pnaq1zcPyf+EhrfQNBdh8dlFKRSqnojm3gQmAnQfh7prUuB44qpcY7i84HduOLe/H3A4R+PmS4GNiHo6/zx/6uTz/r/BJwDLDi+MS+FUef5YfAfmANkOA8V+EYyXMA2AHk+7v+bvexAMdXw+3AVufPxcF4L876TQW2OO9nJ/CAs3wUsBEoAv4NhDnLzc79IufxUf6+hx7uaSHwVjDfh7Pe25w/uzr+nwfx79l0oMD5e/Y6EO+Le5Gp/0IIMUwEQ5eLEEKIfpCALoQQw4QEdCGEGCYkoAshxDAhAV0IIYYJCehCCDFMSEAXQohh4v8DLTDs+7EozuQAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>This very funny British comedy shows what might happen if a section of London, in this case Pimlico, were to declare itself independent from the rest of the UK and its laws, taxes &amp; post-war restrictions. Merry mayhem is what would happen.&lt;br /&gt;&lt;br /&gt;The explosion of a wartime bomb leads to the discovery of ancient documents which show that Pimlico was ceded to the Duchy of Burgundy centuries ago, a small historical footnote long since forgotten. To the new Burgundians, however, this is an unexpected opportunity to live as they please, free from any interference from Whitehall.&lt;br /&gt;&lt;br /&gt;Stanley Holloway is excellent as the minor city politician who suddenly finds himself leading one of the world's tiniest nations. Dame Margaret Rutherford is a delight as the history professor who sides with Pimlico. Others in the stand-out cast include Hermione Baddeley, Paul Duplis, Naughton Wayne, Basil Radford &amp; Sir Michael Hordern.&lt;br /&gt;&lt;br /&gt;Welcome to Burgundy!</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>So, Todd Sheets once stated that he considers his 1993, shot-on-video Z-epic, Zombie Bloodbath to be his first feature film. Anyone who's ever seen a little beauty called Zombie Rampage knows exactly how untrue that statement is. I mean, what makes this one that much more superior? Well, then again, Zombie Rampage doesn't include that mullet guy, now does it? &lt;br /&gt;&lt;br /&gt;For one to comprehend exactly why Zombie Bloodbath is actually considered worth a damn, one must remember what the 90's were like for lovers of bad horror. A decade that all but said goodbye to B and Z-cinema as we knew it. Technological advances, awkward trends, and the internet would abolish the mysterious charms of the s.o.v.'s big-boxed golden years. And anything remotely resembling quality schlock was all too self-aware for it's own good, basically defeating the purpose. Luckily, not everyone changes with the times. Enter Zombie Bloodbath.&lt;br /&gt;&lt;br /&gt;And I guess this is the part where I explain the same exact premise from 500 other zombie flicks from the last 40 years. Alright, so, Some kind of accident at a nuclear plant infects everyone in sight, turning them into flesh-eating zombies, who go on a rampage, inflicting some of the most gruesome, yet humorous gore-scenes of the 90's. The first 20 minutes are cluttered with the most awkward-sounding conversations you could imagine. Conversations that let you know that this isn't just a low-budget zombie flick, this is a Z-grade disasterpiece, fella. plenty Hysterical, non-existent acting to go around, and that goes triple for Mr. Mullet. That guy is truly the highlight of the night.&lt;br /&gt;&lt;br /&gt;The fact that Todd Sheets seriously considers Zombie Bloodbath to be THAT superior to Zombie Rampage, amuses me to no end. I mean really, both are complete jokes on celluloid, but then again, so is Redneck Zombies, so, obviously Todd Sheets is in the company of awsomeness. By 1993, a movie this bad would no doubt, be a full-blast spoof, but Mr. Sheets stands his ground, giving us some good old fashion schlock, the way it was meant to be, unaware, clueless, and pointless. God bless Todd Sheets. For anyone seeking surprisingly worthwhile 90's B-Horror, Leif</td>
      <td>positive</td>
      <td>negative</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This was a really good movie&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;positive&#39;, tensor(1), tensor([0.0862, 0.9138]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;Acting was so bad it was almost funny.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;negative&#39;, tensor(0), tensor([0.9948, 0.0052]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;seq_class_learn_export.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;seq_class_learn_export.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;negative&#39;, tensor(0), tensor([0.9772, 0.0228]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;negative&#39;, tensor(0), tensor([0.9772, 0.0228]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2><p>The tests below to ensure the core training code above works for <strong>all</strong> pretrained sequence classification models available in huggingface.  These tests are excluded from the CI workflow because of how long they would take to run and the amount of data that would be required to download.</p>
<p><strong>Note</strong>: Feel free to modify the code below to test whatever pretrained classification models you are working with ... and if any of your pretrained sequence classification models fail, please submit a github issue <em>(or a PR if you'd like to fix it yourself)</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_models</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="s1">&#39;SequenceClassification&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[transformers.modeling_albert.AlbertForSequenceClassification,
 transformers.modeling_auto.AutoModelForSequenceClassification,
 transformers.modeling_bart.BartForSequenceClassification,
 transformers.modeling_bert.BertForSequenceClassification,
 transformers.modeling_camembert.CamembertForSequenceClassification,
 transformers.modeling_distilbert.DistilBertForSequenceClassification,
 transformers.modeling_electra.ElectraForSequenceClassification,
 transformers.modeling_flaubert.FlaubertForSequenceClassification,
 transformers.modeling_longformer.LongformerForSequenceClassification,
 transformers.modeling_mobilebert.MobileBertForSequenceClassification,
 transformers.modeling_roberta.RobertaForSequenceClassification,
 transformers.modeling_xlm.XLMForSequenceClassification,
 transformers.modeling_xlm_roberta.XLMRobertaForSequenceClassification,
 transformers.modeling_xlnet.XLNetForSequenceClassification]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;albert-base-v1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;facebook/bart-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bert-base-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;camembert-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;distilbert-base-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;monologg/electra-small-finetuned-imdb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;flaubert/flaubert_small_cased&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;allenai/longformer-base-4096&#39;</span><span class="p">,</span>
    <span class="s1">&#39;google/mobilebert-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;roberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlm-mlm-en-2048&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlm-roberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlnet-base-cased&#39;</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMDB_SAMPLE</span><span class="p">)</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">)</span>
<span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;texts.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># so we can test XMLForSequenceClassification models</span>
<span class="n">remove_summary_patch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="c1">#hide_output</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">SequenceClassification</span>
<span class="n">test_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">pretrained_model_names</span><span class="p">:</span>
    <span class="n">error</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">del</span> <span class="n">learn</span> 
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1"> ===</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> 
                                                                                   <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
                                                                                   <span class="n">config_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_labels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;architecture:</span><span class="se">\t</span><span class="si">{</span><span class="n">hf_arch</span><span class="si">}</span><span class="se">\n</span><span class="s1">tokenizer:</span><span class="se">\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">model:</span><span class="se">\t\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">),</span> <span class="n">CategoryBlock</span><span class="p">)</span>

    <span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                       <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> 
                       <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> 
                       <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;is_valid&#39;</span><span class="p">))</span>
    
    <span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                    <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
                    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                    <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

    <span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
    
    <span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING DataLoaders ***&#39;</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">128</span><span class="p">]))</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING One pass through the model ***&#39;</span><span class="p">)</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING Training/Results ***&#39;</span><span class="p">)</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;PASSED&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;FAILED&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arch</th>
      <th>tokenizer</th>
      <th>model</th>
      <th>result</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>albert</td>
      <td>AlbertTokenizer</td>
      <td>AlbertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>bart</td>
      <td>BartTokenizer</td>
      <td>BartForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>bert</td>
      <td>BertTokenizer</td>
      <td>BertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>camembert</td>
      <td>CamembertTokenizer</td>
      <td>CamembertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>distilbert</td>
      <td>DistilBertTokenizer</td>
      <td>DistilBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>electra</td>
      <td>ElectraTokenizer</td>
      <td>ElectraForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>flaubert</td>
      <td>FlaubertTokenizer</td>
      <td>FlaubertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>longformer</td>
      <td>LongformerTokenizer</td>
      <td>LongformerForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>mobilebert</td>
      <td>MobileBertTokenizer</td>
      <td>MobileBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>roberta</td>
      <td>RobertaTokenizer</td>
      <td>RobertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>xlm</td>
      <td>XLMTokenizer</td>
      <td>XLMForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>11</th>
      <td>xlm_roberta</td>
      <td>XLMRobertaTokenizer</td>
      <td>XLMRobertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td>xlnet</td>
      <td>XLNetTokenizer</td>
      <td>XLNetForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-Multi-label-classification">Example: Multi-label classification<a class="anchor-link" href="#Example:-Multi-label-classification"> </a></h2><p>Below demonstrates how to setup your <code>blurr</code> pipeline for a multi-label classification task</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># creates a dataset with the first 10% of training set</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;civil_comments&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train[:1%]&#39;</span><span class="p">)</span> 
<span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Using custom data configuration default
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>18049</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toxic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
<span class="n">toxic_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>toxicity</th>
      <th>severe_toxicity</th>
      <th>obscene</th>
      <th>threat</th>
      <th>insult</th>
      <th>identity_attack</th>
      <th>sexual_explicit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>This is so cool. It's like, 'would you want your mother to read this??' Really great idea, well done!</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Thank you!! This would make my life a lot less anxiety-inducing. Keep it up, and don't let anyone get in your way!</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>This is such an urgent design problem; kudos to you for taking it on. Very impressive!</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Is this something I'll be able to install on my site? When will you be releasing it?</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>haha you guys are a bunch of losers.</td>
      <td>0.893617</td>
      <td>0.021277</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.87234</td>
      <td>0.021277</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lbl_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">toxic_df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]);</span> <span class="n">lbl_cols</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;severe_toxicity&#39;,
 &#39;obscene&#39;,
 &#39;threat&#39;,
 &#39;insult&#39;,
 &#39;identity_attack&#39;,
 &#39;sexual_explicit&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toxic_df</span> <span class="o">=</span> <span class="n">toxic_df</span><span class="o">.</span><span class="n">round</span><span class="p">({</span><span class="n">col</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">lbl_cols</span><span class="p">})</span>
<span class="n">toxic_df</span> <span class="o">=</span> <span class="n">toxic_df</span><span class="o">.</span><span class="n">convert_dtypes</span><span class="p">()</span>

<span class="n">toxic_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>toxicity</th>
      <th>severe_toxicity</th>
      <th>obscene</th>
      <th>threat</th>
      <th>insult</th>
      <th>identity_attack</th>
      <th>sexual_explicit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>This is so cool. It's like, 'would you want your mother to read this??' Really great idea, well done!</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Thank you!! This would make my life a lot less anxiety-inducing. Keep it up, and don't let anyone get in your way!</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>This is such an urgent design problem; kudos to you for taking it on. Very impressive!</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Is this something I'll be able to install on my site? When will you be releasing it?</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>haha you guys are a bunch of losers.</td>
      <td>0.893617</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">SequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;roberta-base&quot;</span> <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lbl_cols</span><span class="p">)</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> 
                                                                               <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
                                                                               <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note how we have to configure the <code>num_labels</code> to the number of labels we are predicting. Given that our labels are already encoded, we use a <code>MultiCategoryBlock</code> with <code>encoded=True</code> and <code>vocab</code> equal to the columns with our 1's and 0's.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># single input</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">),</span> 
    <span class="n">MultiCategoryBlock</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vocab</span><span class="o">=</span><span class="n">lbl_cols</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="n">lbl_cols</span><span class="p">),</span> 
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">toxic_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([8, 512]), torch.Size([8, 6]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>None</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>You don't speak for "most Alaskans".</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>Great article! Definitely concur with you about the experience and what people are missing out on. I also wrote an article on my personal blog. Feel free to check it out. https://hingpotter.wordpress.com/  Thanks for coming to Boise!!!</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">BCEWithLogitsLossFlat</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">accuracy_multi</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we're doing multi-label classification, we adjust our loss function to use binary cross-entropy and our metrics to use the multi-label friendly version of accuracy.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([8, 6])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.010000000149011612, lr_steep=1.3182567358016968)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEKCAYAAAAfGVI8AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3de3xU9Z3/8ddnJjdCSIAQQANyR0RULOGm661qReuibbcqrVatlfqr1lvrrr1sL+663Xa73dY7FFHrqmjd2tJKtd1tqTcEooKCiiKg3IRwTSC3yeTz+2MmYYxJSCAnM5N5Px+PPMicc2bmnTGeT77f7znfr7k7IiKSuULJDiAiIsmlQiAikuFUCEREMpwKgYhIhlMhEBHJcCoEIiIZLivZATprwIABPnz48GTHEBFJK6+88soOdy9pbV/aFYLhw4dTXl6e7BgiImnFzN5va5+6hkREMpwKgYhIhlMhEBHJcCoEIiIZToVARCTDqRCIiGQ4FQIRkW6wavNeGhtTc9p/FQIRkYBt3FXN+Xe+wLwX1iU7SqtUCEREAranOgLA3OfWUVMfTXKaj1MhEBEJWE0kdvLfsa+eR5a2eYNv0qgQiIgErKkQFPfOYc5z66iNpFarQIVARCRgTd1B131yNBVVdSxY9kGSE32UCoGISMCaWgCnHz2QKSP6c+/f3kupVoEKgYhIwJq6hnplh7nxzDFsq6zjifKNSU51QGCFwMzmm9l2M1vVxv5xZrbEzOrM7JtB5RARSbamrqFe2WGmjypm8vB+3PPX1GkVBNkieBCY0c7+XcD1wE8DzCAiknRNLYK8nBBmxk1nj+XDytqUGSsIrBC4+3PETvZt7d/u7suBSFAZRERSQW0kSsggJxw75Z40agBTR/Tn7sWp0SpIizECM5ttZuVmVl5RUZHsOCIinVJTH6VXdhgza95209ljqaiq479fTv59BWlRCNx9rruXuXtZSUmrS26KiKSsmkiUXjnhj2ybNrKYk0cXc9/f3qO6viFJyWLSohCIiKSzmkiUvOzwx7bfdNZYduyr5+ElyW0VqBCIiASsNhLrGmqpbHh/Th1bwn1/e4+q2uQNlwZ5+ehjwBLgaDPbZGZXmdk1ZnZNfP9gM9sE3Ax8N35MYVB5RESSpab+411DTb75qbHsro4w/4UN3RsqQVZQL+zusw6y/0NgSFDvLyKSKtrqGgI4fkhfzjl2EPOeX8eXpg+jX++cbk6nriERkcDVRBpb7Rpq8o1PHc2++gbue+69bkx1gAqBiEjAautbHyNoMnZQHy6cWMpDL21ge2VtNyaLUSEQEQlYa5ePtnTjWWNoiDp3/XVtN6U6QIVARCRg7Y0RNBlW3JuLJg/lsWUfsHFXdTcli1EhEBEJ2MG6hppc/8kxhEPGz/78TjekOkCFQEQkYLGuoYOfbgcX5XHlySP47YrNvLmlshuSxagQiIgEKBJtpKHRO9QiALjmtFEU5mXzk2ffDjjZASoEIiIBap6CuoOFoKhXNteeMYrFaypY8t7OIKM1UyEQEQlQbdOiNAe5aijRl6YP54iiPP79mbdx96CiNVMhEBEJUOIylR2Vlx3mprPGsnLjHp5Z9WFQ0ZqpEIiIBOhQCgHA5yYNYeygAn78zNvUNzQGEa2ZCoGISICa1ivO60TXEEA4ZHzr3GPYsLOaR5cGO021CoGISIAOtUUAcPrRJZw0qphf/N+7VAY4TbUKgYhIgGoPoxCYGd8+7xh2V0e4d3FwE9KpEIiIBKimPta/35mrhhJNKC3iMyeWMv+F9WzZU9OV0ZoFuTDNfDPbbmar2thvZnaHma01s9fN7BNBZRERSZbD6Rpq8o1PjcWBuwOakC7IFsGDwIx29p8LjIl/zQbuDTCLiEhSdPaGstYM6ZfP3Msm8U/njuuqWB8RWCFw9+eAXe0ccgHwK495GehrZkcElUdEJBkO5Yay1px+9EAK87K7ItLHJHOMoBTYmPB4U3zbx5jZbDMrN7PyioqKbgknItIVmlsEWak7JJu6yRK4+1x3L3P3spKSkmTHERHpsJpIlJxwiKxw6p5uk5lsMzA04fGQ+DYRkR6jpj5KXnbqFgFIbiFYCHwpfvXQNGCvu29NYh4RkS5X24FlKpMtK6gXNrPHgNOBAWa2Cfg+kA3g7vcBi4DzgLVANXBlUFlERJKlJtKx1cmSKbBC4O6zDrLfgWuDen8RkVQQ6xpK7UKQ2h1XIiJpriYNuoZUCEREAlSbBl1DKgQiIgFKhzECFQIRkQDV1Ec7vRZBd1MhEBEJUG2kUS0CEZFMpq4hEZEMV1Ovq4ZERDKWu1MT0X0EIiIZq64hvjqZCoGISGaqaVqLQJPOiYhkpuZlKjVGICKSmbpimcruoEIgIhKQA11DKgQiIhmpVl1DIiKZrXmMIJNbBGY2w8zWmNlaM7u1lf3DzOz/zOx1M1tsZkOCzCMi0p2auoYydozAzMLA3cC5wHhglpmNb3HYT4FfufvxwG3Aj4LKIyLS3TRYDFOAte6+zt3rgQXABS2OGQ/8Jf79X1vZLyKStjRGAKXAxoTHm+LbEq0EPhv//jNAHzMrbvlCZjbbzMrNrLyioiKQsCIiXU1XDXXMN4HTzOw14DRgMxBteZC7z3X3MncvKykp6e6MIiKHpCaSHlNMBLZ4PbGT+tCEx0Pi25q5+xbiLQIzKwA+5+57AswkItJtmsYIcrOS/Td3+4JMtxwYY2YjzCwHuARYmHiAmQ0ws6YM3wLmB5hHRKRb1Uai5GWHCIUs2VHaFVghcPcG4DrgWeAt4Al3X21mt5nZzPhhpwNrzOwdYBBwe1B5RES6W0196i9KA8F2DeHui4BFLbZ9L+H7J4Eng8wgIpIs6bA6GSR/sFhEpMeqiaT+wvWgQiAiEpjaNOkaUiEQEQmIuoZERDJcTST1F64HFQIRkcDU1Kf+wvWgQiAiEphadQ2JiGQ2jRGIiGS4mnqNEYiIZLTaSKPGCEREMlW00amPNqprSEQkUx1YlCb1T7Opn1BEJA2ly8L1oEIgIhKIdFm4HlQIRES6jLvTEI2tSpYu6xWDCoGISJf5ybNrOOfnz7G/rkFdQ03MbIaZrTGztWZ2ayv7jzKzv5rZa2b2upmdF2QeEZEgbdixn/cq9nP7orfSZuF6CHBhGjMLA3cDZwObgOVmttDd30w47LvEVi6718zGE1vEZnhQmUREgtTUCnh06QfN6xSnw3oEQa5QNgVY6+7rAMxsAXABkFgIHCiMf18EbAkwj4hIoKrro0wc2pfq+gYeeHEDkB4tgiC7hkqBjQmPN8W3JfoBcKmZbSLWGvh6gHlERAJVG4nSNz+bn100kaz4gvWZXgg6YhbwoLsPAc4DHjazj2Uys9lmVm5m5RUVFd0eUkSkI6rro+TnhJlQWsRNZ48lJxyiX++cZMc6qCALwWZgaMLjIfFtia4CngBw9yVAHjCg5Qu5+1x3L3P3spKSkoDiiogcnsT1B649YzTl/3wWRb2yk5zq4IIsBMuBMWY2wsxygEuAhS2O+QA4E8DMjiFWCPQnv4ikpZpIrEXQpDAv9YsABFgI3L0BuA54FniL2NVBq83sNjObGT/sG8DVZrYSeAy4wt09qEwiIkGqSZPF6lsK8qoh3H0RsUHgxG3fS/j+TeDkIDOIiHSHxkaPr1Ec6Gk1EMkeLBYR6RHqGmJTS6Rji0CFQESkC1TXNwB8ZIwgXagQiIh0gXSaW6ilDhUCM+vddH2/mY01s5lmlh7D4SIi3aB5bqEe3CJ4Dsgzs1LgT8BlwINBhRIRSTc9vkUAmLtXA58F7nH3zwPHBhdLRCS9VMdbBD15jMDMbDrwReDp+Lb0+2lFRALS1CJIh9lGW+poIbgR+BbwVPymsJHAX4OLJSKSXmrSuEXQoTsf3P1vwN8A4oPGO9z9+iCDiYikk3RaiKaljl419KiZFZpZb2AV8KaZ3RJsNBGR9FGdRmsUt9TRrqHx7l4JXAj8ERhB7MohEREBant6iwDIjt83cCGw0N0jxFYXExERDlw11JMLwRxgA9AbeM7MhgGVQYUSEUk3NZEoOeEQWeH0m7Cho4PFdwB3JGx638zOCCaSiEj6qalvSMvxAehgITCzIuD7wKnxTX8DbgP2BpQrrTU2Ojv317OtspbtVbXs3h9hT02EvTURGqKNzcdlhUMU5IYpyM0mJytEXUOUmvootZEoVXUNVNU2sK+2ger4tppIfH9DlNr6KJFGJ2xGOGSEQhA2IxQyQmZEoo3URqLURhoJGeRlh+mVHSY3O0x+zoGvpu152WFys0LkZIXIDocIx9dbBQiZkRUyssJGVjgUf08Ih0LkZsW/ssNkh635ublZIXrnZJGfE6Z3buxfM2vt4xLpEWoi6bkWAXR8PYL5xK4Wuij++DLgAWJ3GrfJzGYAvyB289k8d//3Fvv/C2hqWeQDA929bwczdanGRqc6EqW6roFIo5Mdip1g66ONrPmwire2VvHOtiq27q1he1UdFVV11EUaibrT6I47hENG2IyoO9HGjw+hmNG8oDVAJNr2MEtOVojCvCz65GXTKztMr5wwedkh+vbKjn8fJjscorHRaWiMZYg2OlF33J3scIi8rDC52SHcaS4ktZEo1fVRqmob2F5ZR228+NREotQ3NFIfbSSIpYHCIaMwL4vCXtn0zc+hf342/Xrn0LdXDn3i2/vlZzOwTx4lfXIZXJhHUb6ms5L00bRecTrqaCEY5e6fS3j8QzNb0d4TzCwM3A2cDWwClpvZwvhiNAC4+00Jx38dOLHDyQ9BVW2E1VsqWbV5L6u3VLJlTw0V8ZN6VV3DQZ9/ZFEepf16MW5wH04ZPYD83CxCFvtLHIgXAAiHYFBhHgP75DGoMJf+CSe8UEIhaGx09tc3sL8uSl1DtPkv9l7ZYXKyktPP6H6gsBzICQ2NjTREnUhjI42NsZ+1IdoYb3nEWh+RqMeOa3Tq4gWnuj7KvroGqmojVNY0sLcmwu7qeir21fHOtn3srYmwr43PvjAvi2HFvTmqOJ8Rxb0ZPqA3w4vzOao4n5KCXLUwJKXURg6sV5xuOloIaszs79z9BQAzOxmoOchzpgBr3X1d/DkLgAuAN9s4fhax7qdA/G7FZm5YcKB2DSrM5aj++RxzRCGnjs2lqFc2vXPD9MrJIjtkNDTGTnThcIgxAws4ZnBhl/+FGgoZffKy6ZNC65qaGdnh1k6wwf2CRxudqtoIu6sjbK+spWJfHR/ureX9ndW8v6uaVZv38syqDz/SysrLDjG0Xz4jBvRm9MACxgwq4OhBhYwZVEB2Gg7WSfrLhBbBNcCv4mMFALuByw/ynFJgY8LjTcDU1g6MX4U0AvhLB/N02vFD+nLz2WM5rrSICaVFlPTJDeqtpJPCIaNvfg5983MYMaB3q8dEoo1s3FXNhp372birhg92VfPBrmrW7djPX97eTkO8SORmhZhQWsQJQ/pyypgBTBtZnLYDeJJeaiJRCnLTb5lK6PhVQyuBE8ysMP640sxuBF7vohyXAE+6e7S1nWY2G5gNcNRRRx3SG4wY0JvrzxxzyAElubLDIUaWFDCypOBj++obGnl/537e3FrJ65v28vqmPTyy9H3mv7ie3KwQU0cWM3lYP44bUsRxpUUUF+iPAOl6NfVRStL0d6tT5St+d3GTm4Gft3P4ZmBowuMh8W2tuQS4tp33nQvMBSgrK9ONbPIROVkhxgzqw5hBfbhgYikQ669dtn4Xi9dU8Ny7FfznOxXNx48b3IdPH3cE559wZJstEJHOii1cn56tz8NpxxxspG45MMbMRhArAJcAX/jYi5iNA/oBSw4ji8hH5GWHOXVsCaeOLQGgsjbC6s2VrNy0h/97axv/+ed3+M8/v8OxRxZy3nFH8OnjjmC4ioIchkwYI2hNu3+Zu3uDmV0HPEtspHF+fArr24Byd18YP/QSYIF7EBctisQU5mUzfVQx00cVc81po9i6t4anX9/K029s5T+eXcN/PLuGCaWFXDp1GBeeWJq2V39I8tTWp+9VQ9be+dfMqmj9hG9AL3fv9pGRsrIyLy8v7+63lR5s854a/vjGVp58ZRNvf1hF3/xsZk05ikunDaO0b69kx5M04O6M/s4fuea0kdxyzrhkx2mVmb3i7mWt7Wv3RO7ufYKJJJI6Svv24iunjOSqvxvBsvW7ePClDcz523vM+dt7nHnMIC6fPpyTRxfrvgVpUyQau6Gzp99ZLNLjmRlTRxYzdWQxm/fU8MjL77Ng+Ub+/OY2JpQW8u1zj+Gk0QOSHVNSUPOiNDnpeUrVnTcirSjt24t/nDGOl279JP/xD8eze3+EL8xbypcfXM6726qSHU9STNN6xenaIlAhEGlHXnaYz5cN5f++cRq3njuO5Rt2ce4vnudnf1pDbaTV214kA1XXx6ZJSderhlQIRDogLzvMNaeNYvE3T2fmCUdyx1/Wct4dz7Ns/a5kR5MU0NQiSNerhlQIRDqhuCCXn108kYe+PIW6SCMXz13CPYvXoqufM1vTGIFaBCIZ5LSxJfzpplM5//gj+ckza7h+wYrmk4Fknpo0XrgeVAhEDlnv3CzuuGQi/zRjHH94fQv/cN9LrN+xP9mxJAnSeb1iUCEQOSxmxv87fRTzL5/Mxl3VzPj5c9y7+D0iCSvRSc9XqxaBiJwxbiD/e/NpnHH0QH78zNtcePeLrPlQl5lmimqNEYgIwMDCPO67bBL3XfoJtlXWcdGcJazcuCfZsaQb1KhrSEQSzZhwBE997SQKe2Vx6bylvPK+LjHt6TRYLCIfM7R/Po/Pns6APrlcdv8ylry3M9mRJEA19VFCBjlpukxqeqYWSQNH9u3F47OncWTfXlzxwDIWr9me7EgSkNhaBFlpOzGhCoFIgAYW5vH47GmMKing6l+V88yqD5MdSQJQE0nftQhAhUAkcMUFuTx29TQmlBZx7aOv8rsVba3YKumqpr4hba8YgoALgZnNMLM1ZrbWzG5t45iLzOxNM1ttZo8GmUckWYrys3n4qqlMHt6PGx9fwcKVW5IdSbpQTSSatlcMQYCFwMzCwN3AucB4YJaZjW9xzBjgW8DJ7n4scGNQeUSSrSA3iweumMLk4f25+fEV/PnNbcmOJF2kuj59F66HYFsEU4C17r7O3euBBcAFLY65Grjb3XcDuLtG06RH65UT5v7Lyzj2yEKufeRVXnh3R7IjSReoVYugTaXAxoTHm+LbEo0FxprZi2b2spnNaO2FzGy2mZWbWXlFRUVAcUW6R5+8bB768hRGlvTm6l+V62qiHiB21ZAKwaHKAsYApwOzgF+aWd+WB7n7XHcvc/eykpKSbo4o0vX65ufw8FVTGT6gN19+cDnzX1ivqazTWE0kSp4KQas2A0MTHg+Jb0u0CVjo7hF3Xw+8Q6wwiPR4JX1yefKa6Zx1zCBu+8ObfPupVZqsLk3V1EfJV9dQq5YDY8xshJnlAJcAC1sc81tirQHMbACxrqJ1AWYSSSm9c7O479JJXHvGKB5b9gHXPvIqDSoGaacmosHiVrl7A3Ad8CzwFvCEu682s9vMbGb8sGeBnWb2JvBX4BZ31734klFCIeOWc8bx/b8fz5/e3MY//26VuonSTLpfNZQV5Iu7+yJgUYtt30v43oGb418iGe3Kk0ewc189d/11LQMKcvnGp45OdiTpgGijU9/QmNZXDQVaCESkc77xqbHs2FfHnX+JFYPLTxqe7EhyEE0zj6bzVUMqBCIpxMz41wsnsHN/PT/4/WoGFeYxY8LgZMeSdqT7WgSQ/MtHRaSFrHCIOy45kYlD+3LDgtd45f3dyY4k7WguBDnp+3e1CoFICuqVE2bel8o4oiiPrzy0nPU79ic7krSheVEatQhEpKsVF+Ty4JVTMDOueGAZu/bXJzuStKK6vgFI7zECFQKRFDZ8QG/mXV7G1r21XPPwK9Q1RJMdSVpoahFoPQIRCcwnjurHTz9/Ass27OLbv9E9BqmmaYwgnVsE6Tu6IZJBZp5wJOsq9vHz/32XUQN787XTRyc7Uo/0xqa95OeGGVVS0OHnpPvC9aAWgUjauOHMMcw84Uh+8swaFr2xNdlxeqSbn1jBhXe9yGsfdPxKrWpdPioi3cXM+Mk/HM+kYf246fEVvNqJk5V0zNa9tVTVNXDZ/cs6fNlurVoEItKd8rLDzL1sEoMK87j6oXI+2Fmd7Eg9xv66BvbVNXDFScMZUJDD5fOX8cr7uw76vOoeMEagQiCSZooLcnngysk0NDpXPLiMPdW6rLQrbK+qA+D4IUUsmD2dgX1yuez+Zby8rv15MJsGi/OyVAhEpBuNKilg7mWT2LSrhgvufpFVm/cmO1La21ZZC8CgwjwGF+WxYPY0Svv24ooHlvHcO22vjFgTiZKXHSIUsu6K2uVUCETS1NSRxTx69VTqIo189p6XeHjJBl1aehiaWgQD++TG/i2MFYORAwr4ykPl/O+b21p9Xk19eq9XDCoEImmtbHh/Ft1wCieNLuaff7eaGxasaB68lM7ZHm8RDCzMa95WXJDLY1dP45gjC7nmv1/hdytaLrLYtF5xel+JH2ghMLMZZrbGzNaa2a2t7L/CzCrMbEX86ytB5hHpifr3zmH+5ZO55Zyj+f3rW7h4zpLmk5p03LbKWnKzQhTmffSkXpSfzX9fNYVJw/px4+MreGTp+x/ZXxvvGkpngaU3szBwN3AuMB6YZWbjWzn0cXefGP+aF1QekZ4sFDKuPWM09106iXe372PmXRo36KztVXUMKszD7ON9/X3ysnnoy1P45NED+c5Tq7hn8drmfdX1DWoRtGMKsNbd17l7PbAAuCDA9xPJeOccO5hfXzOdkMHFc5awYuOeZEdKG9sqa5vHB1qTlx3mvssmccHE2E19/7boLRobPbZescYI2lQKbEx4vCm+raXPmdnrZvakmQ1t7YXMbLaZlZtZeUVF26P3IgLHHlnEb752Mv0LcrjigWW8s60q2ZHSQlOLoD3Z4RD/ddFEvjR9GHOfW8c3n1xJVW1DWt9MBskfLP49MNzdjwf+DDzU2kHuPtfdy9y9rKSkpFsDiqSjwUV5PHLVNHLCIS6dt1Q3nnXA9so6Bha23SJoEgoZP5x5LN84eyy/eXUzq7dUqkXQjs1A4l/4Q+Lbmrn7Tneviz+cB0wKMI9IRjmqOJ+Hr5pKfbSRS+9f2nydvHxc013FA/u03yJoYmZ8/cwx/OizxxEyKOylMYK2LAfGmNkIM8sBLgEWJh5gZkckPJwJvBVgHpGMc/TgPjx45RR27a/nC798mYqquoM/KQM13UMwqAMtgkSzphzFU187mZvOHhtErG4TWCFw9wbgOuBZYif4J9x9tZndZmYz44ddb2arzWwlcD1wRVB5RDLVxKF9mX/FZLbsqeXSeUu10lkrmu8h6GCLINEJQ/tyRFGvro7UrQIdI3D3Re4+1t1Hufvt8W3fc/eF8e+/5e7HuvsJ7n6Gu78dZB6RTDVlRH/uv7yMDTv3c+m8peytjiQ7UkrZdogtgp4i2YPFItJNTho9gLlfKmPt9n1cer+KQaLDaRH0BCoEIhnktLElzLlsEms+rOKL97+smUvjtlfVxe4qTvNB30OlQiCSYc4YN5A5l03inQ/38cV5S1UMiLUI2rqrOBOoEIhkoDPGDWTOl2LTUcz65VJ27Mvsq4m2Vda1e1dxT6dCIJKhzjh6IPO+VMb6Hfu4eM6SjL7PYFtV7UHvKu7JVAhEMtipY0t46MopfLi3lovmLGHT7sy8A7miso4StQhEJFNNHVnMf39lKrv313PRfUtYu31fsiN1q+r6BqrqGtQiEJHMduJR/Vgwezr1UeeiOUt4Y1PmTGG9vfKjK5NlIhUCEQFg/JGFPHnNdPJzwsz65cssea/9Rdt7isS1ijOVCoGINBs+oDdPXnMSR/bN4/IHlvHHN7YmO1LgmtcqztC7ikGFQERaGFyUxxNfnc5xpUV87dFXeeilDcmOFKjmFkGG3lUMKgQi0oq++Tk88pWpnHXMIL6/cDU/fuZt3D3ZsQJRkeF3FYMKgYi0IS87zL1f/ARfmHoU9y5+jxsWrKCuIZrsWF1uW2UtAwtzM/auYlAhEJF2ZIVD3H7hBG4552gWrtzCZfOWsTvNp7Gub2jkqdc2UV3fAMSXqMzgbiFQIRCRgzAzrj1jNHfMOpEVm/bw2Xtf4uV1O9O2dbBw5RZuenwlF979Iusq9jW3CDJZoIXAzGaY2RozW2tmt7Zz3OfMzM2sLMg8InLoZp5wJI9+ZSp7quu5ZO7LHP+DP3HxnCU89NKGtBo/WL5+FwW5WVRU1THzrhfZuLsmY6efbhJYITCzMHA3cC4wHphlZuNbOa4PcAOwNKgsItI1yob3Z/E3z+C+Sydx6bRhVNU28P2Fq7nu0deau1pS3fINu5g2sj9/uP4URg8soL6hkcFFmV0IghwmnwKsdfd1AGa2ALgAeLPFcf8C/Bi4JcAsItJFivKzmTFhMDMmDMbd+eXz6/jRH99m/Y79/PLyMkr7pu6yjTv21bFux34umjyU0r69eOKr03nqtU18avzgZEdLqiC7hkqBjQmPN8W3NTOzTwBD3f3pAHOISEDMjNmnjmL+5ZPZuKuamXe+wMvrUveO5PINuwGYPLw/ADlZIS6efBT9euckM1bSJW2w2MxCwM+Ab3Tg2NlmVm5m5RUVFcGHE5FOOWPcQJ669mSK8rP54rylzH9hfUqOGyzfsIvcrBDHlRYlO0pKCbIQbAaGJjweEt/WpA8wAVhsZhuAacDC1gaM3X2uu5e5e1lJSUmAkUXkUI0eWMDvrj2ZT44byG1/eJObHl9BTX1qXVlUvmEXE4f2JSdLF0wmCvLTWA6MMbMRZpYDXAIsbNrp7nvdfYC7D3f34cDLwEx3Lw8wk4gEqE9eNnMuncTNZ4/ldyu38Jl7YpdopoL9dQ2s2lLZ3C0kBwRWCNy9AbgOeBZ4C3jC3Veb2W1mNjOo9xWR5AqFjOvPHMMDV0zmw8paZt71IotSYPK6FRv3EG10yob3S3aUlBNo+8jdF7n7WHcf5e63x7d9z90XtnLs6WoNiPQcpx89kKevP4VRAwv42iOv8sPfr07qTWjLN+wiZDBpmApBS+ooE5HAlBoA9p4AAAqsSURBVPbtxa+/Op0rThrOAy9u4B/uXcL7O/cnJcvyDbsYN7iQPnnZSXn/VKZCICKByskK8YOZxzLnskm8v3M/n77jBX6/cku3ZohEG3ntgz1MVrdQq1QIRKRbnHPsYJ6+/hTGDCrg64+9xi2/Xsn+uu65G/nNLZVU10eZPEIDxa1RIRCRbjO0fz5PfHU6150xmidf3cT5d77A65v2BP6+TTe56Yqh1qkQiEi3yg6H+OY5R/PY1dOojUT57D0vcddf3qUh2hjI++3eX8+c59YxaVi/jF6XuD0qBCKSFNNGFvPHG07h3OOO4Kd/eofPz1nChh1dP5B8+6K3qKyJ8K8XTujy1+4pVAhEJGn65udw56wT+cUlE3lv+z7O/cXzPPDiehobu2Z6ipfW7uDJVzZx9akjOeaIwi55zZ5IhUBEku6CiaU8e9OpTBnRnx/+/k0+P2cJa7d37I7k2kjr9ybURqJ857erGFaczw1njunKuD2OCoGIpIQjinrx4JWT+dlFJ/BexT7O+8Xz3P3XtUTaGTt4ZtVWJnz/WW79n9fZWxNp3r6vroEf/n4163fs5/YLjyMvO9wdP0LaslScIbA9ZWVlXl6uG5BFerKKqjp+sHA1T7+xlWOPLOTHnzueCS1mDN28p4Zzf/4cvXOz2FZZy4CCXL57/nje37Gf+19cz57qCFecNJwfzDw2ST9FajGzV9y91VUgVQhEJGU9s2or3/3tanZX1/PVU0dy/ZljyMsO0xBtZNYvX+atrVU8ff3fUVnTwD/+z+u8tbUSgDPHDeTrZ45h4tC+Sf4JUkd7hSDIFcpERA7LjAlHMG1kMf/yh7e4Z/F7LHpjK//2meNYtmEXyzfs5ucXT2RYcW8AFl53Ms+s+pDhxb05bojWG+gMtQhEJC28uHYH337qDd7fWY0ZfObEUn520cRkx0obahGISNo7efQAnr3xVO78y7u8sbmS2y7QfQFdRYVARNJGXnaYW84Zl+wYPU6gl4+a2QwzW2Nma83s1lb2X2Nmb5jZCjN7wczGB5lHREQ+LrBCYGZh4G7gXGA8MKuVE/2j7n6cu08EfkJsMXsREelGQbYIpgBr3X2du9cDC4ALEg9w98qEh72B9Bq5FhHpAYIcIygFNiY83gRMbXmQmV0L3AzkAJ8MMI+IiLQi6VNMuPvd7j4K+Cfgu60dY2azzazczMorKiq6N6CISA8XZCHYDAxNeDwkvq0tC4ALW9vh7nPdvczdy0pKSrowooiIBFkIlgNjzGyEmeUAlwALEw8ws8QpAT8NvBtgHhERaUVgYwTu3mBm1wHPAmFgvruvNrPbgHJ3XwhcZ2ZnARFgN3B5UHlERKR1aTfFhJlVAO/HHxYBe9v5vuW2bGBHJ98y8TU6sq/lto5mbPp3QCczdle+pm36DFMrXzpkTPV8h5OxvW2p9hkOc/fW+9bdPW2/gLntfd9yG7GWyCG/R0f2tdzW0YwJ/3YqY3fl02eYmvnSIWOq5zucjAfJmlKfYXtfSb9q6DD9/iDft7X/UN+jI/tabutoxlTPd7D3ao8+w4O/T3sO9rxUz5jq+dra35GMB9vWGUF/hm1Ku66hw2Fm5d7G7HupItUzpno+SP2MqZ4PUj9jqueD9MjYJN1bBJ01N9kBOiDVM6Z6Pkj9jKmeD1I/Y6rng/TICGRYi0BERD4u01oEIiLSggqBiEiGUyEQEclwKgRxZnaKmd1nZvPM7KVk52mNmYXM7HYzu9PMUu4ubDM73cyej3+Opyc7T2vMrHd8AsPzk52lNWZ2TPzze9LM/l+y87TGzC40s1+a2eNm9qlk52nJzEaa2f1m9mSyszSJ/949FP/cvpjsPC31iEJgZvPNbLuZrWqxvd0V0hK5+/Pufg3wB+ChVMxIbD2HIcSm5NiUgvkc2AfkpWg+iM1y+0RXZuvKjO7+Vvz38CLg5BTN+Ft3vxq4Brg4BfOtc/erujJXazqZ9bPAk/HPbWbQ2TqtM3e+peoXcCrwCWBVwrYw8B4wkthaByuJrZR2HLGTfeLXwITnPQH0ScWMwK3AV+PPfTIF84XizxsEPJKC+c4mNvnhFcD5qfjfOP6cmcAfgS+kasb48/4T+EQK5+vS/0cOM+u3gInxYx4NMtehfPWIxevd/TkzG95ic/MKaQBmtgC4wN1/BLTaLWBmRwF73b0qFTOa2SagPv4wmmr5EuwGclMtX7y7qjex/zFrzGyRuzemUsb46ywEFprZ08CjXZWvqzKamQH/DvzR3V9NtXzdpTNZibWQhwArSMGemB5RCNrQoRXSWrgKeCCwRB/X2Yy/Ae40s1OA54IMFtepfGb2WeAcoC9wV7DRgE7mc/fvAJjZFcCOriwC7ejsZ3g6sW6EXGBRoMkO6Ozv4deBs4AiMxvt7vcFGY7Of4bFwO3AiWb2rXjB6C5tZb0DuMvMPs2hT0ERmJ5cCDrN3b+f7AztcfdqYsUqJbn7b4gVq5Tm7g8mO0Nb3H0xsDjJMdrl7ncQO7GlJHffSWz8ImW4+37gymTnaEvKNVG6UGdXSEuGVM+ofIdPGQ9fqudLlE5Zm/XkQnDQFdJSQKpnVL7Dp4yHL9XzJUqnrAcke7S6i0bvHwO2cuCyyqvi288D3iE2iv8dZVQ+ZUztjKmeL12zHuxLk86JiGS4ntw1JCIiHaBCICKS4VQIREQynAqBiEiGUyEQEclwKgQiIhlOhUB6BDPb183v1yVrVlhsDYe9ZrbCzN42s5924DkXmtn4rnh/EVAhEGmVmbU7D5e7n9SFb/e8u08ETgTON7ODrUNwIbEZVEW6hAqB9FhmNsrMnjGzVyy2ctq4+Pa/N7OlZvaamf2vmQ2Kb/+BmT1sZi8CD8cfzzezxWa2zsyuT3jtffF/T4/vfzL+F/0j8WmaMbPz4tteMbM7zOwP7eV19xpi0xSXxp9/tZktN7OVZvY/ZpZvZicRW6/gP+KtiFFt/ZwiHaVCID3ZXODr7j4J+CZwT3z7C8A0dz8RWAD8Y8JzxgNnufus+ONxxKbWngJ838yyW3mfE4Eb488dCZxsZnnAHODc+PuXHCysmfUDxnBgivHfuPtkdz8BeIvYFAYvEZu75hZ3n+ju77Xzc4p0iKahlh7JzAqAk4Bfx/9AhwOL5QwBHjezI4itIrU+4akL43+ZN3na3euAOjPbTmz1tZbLcC5z903x910BDCe2ZOc6d2967ceA2W3EPcXMVhIrAj939w/j2yeY2b8SW9+hAHi2kz+nSIeoEEhPFQL2xPveW7oT+Jm7L4wvBPODhH37Wxxbl/B9lNb/n+nIMe153t3PN7MRwMtm9oS7rwAeBC5095XxxXROb+W57f2cIh2iriHpkdy9ElhvZp+H2PKKZnZCfHcRB+aIvzygCGuAkQlLGR50kfd46+HfgX+Kb+oDbI13R30x4dCq+L6D/ZwiHaJCID1FvpltSvi6mdjJ86p4t8tqYmvHQqwF8GszewXYEUSYePfS14Bn4u9TBeztwFPvA06NF5B/BpYCLwJvJxyzALglPtg9irZ/TpEO0TTUIgExswJ33xe/iuhu4F13/69k5xJpSS0CkeBcHR88Xk2sO2pOkvOItEotAhGRDKcWgYhIhlMhEBHJcCoEIiIZToVARCTDqRCIiGQ4FQIRkQz3/wEvqTgg4J8N1AAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy_multi</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.029778</td>
      <td>0.036622</td>
      <td>0.992379</td>
      <td>05:23</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.029847</td>
      <td>0.032721</td>
      <td>0.992887</td>
      <td>05:25</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.029638</td>
      <td>0.029189</td>
      <td>0.992611</td>
      <td>05:26</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>None</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>And The Lord spoke, get thee a fine silken tie and matching shoes to go with your 1000 dollar suit and too expensive haircut, do this in my name and ye shall be rewarded... From the Scriptures of Deacon Hawker, chapter 11, verse 13.  Most High &amp; Pious Edition</td>
      <td></td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>This is a much-needed article, it could be longer. As a 20+ year freelancer, one would think that things such as getting paid would get better with more people doing contract work. But I am having problems getting paid and thisand it's created a huge amount of stress and financial difficulties for me.  I even worked for 3 months with a nonprofit organization that is supposed to help small businesses and contractors yet they didn't pay me one cent! When I applied for small claims court settlement they put two lawyers on me and asked for a jury trial. I would have loved to have continued this but I could't afford the time and stress. So now I am  the average freelancer is owed $5000 or more (according to Freelancers Union). \n\nI am a female and I have also experienced organizations assuming women are volunteers.\n\nAt the very least there is a huge need for trainings on how to work with freelancers in non profits and for profits. Some legal recourse would be great too.</td>
      <td></td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.02</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Those damned affluent white people should only eat their own food, like cod cakes and boiled potatoes. </span>
<span class="s2">No enchiladas for them!</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#1) [&#39;insult&#39;],
 tensor([False, False, False,  True, False, False]),
 tensor([1.3623e-06, 5.1205e-03, 3.5144e-04, 3.1536e-02, 4.8273e-03, 1.0864e-03]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

