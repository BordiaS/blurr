---

title: modeling.question_answering

keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, loss functions, custom splitters, etc... for question answering tasks"
description: "This module contains custom models, loss functions, custom splitters, etc... for question answering tasks"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02c_modeling-question-answering.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#cuda</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Question-Answer">Question Answer<a class="anchor-link" href="#Question-Answer"> </a></h2><p>Given a document (context) and a question, the objective of these models is to predict the start and end token of the correct answer as it exists in the context.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_QstAndAnsModelWrapper" class="doc_header"><code>class</code> <code>HF_QstAndAnsModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/question_answering.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_QstAndAnsModelWrapper</code>(<strong><code>hf_model</code></strong>) :: <a href="/blurr/modeling-core#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a></p>
</blockquote>
<p>A custom model wrapper for question answer models since we need all the outputs (not just the first)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_QstAndAnsModelCallback" class="doc_header"><code>class</code> <code>HF_QstAndAnsModelCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/question_answering.py#L29" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_QstAndAnsModelCallback</code>() :: <a href="/blurr/modeling-core#HF_BaseModelCallback"><code>HF_BaseModelCallback</code></a></p>
</blockquote>
<p>We need to return everything from the model for question/answer tasks</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here we provide a custom loss function our question answer task, expanding on some techniques learned from here and here.</p>
<p>In fact, this new loss function can be used in many other multi-modal architectures, with any mix of loss functions.  For example, this can be ammended to include the <code>is_impossible</code> task, as well as the start/end token tasks in the SQUAD v2 dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiTargetLoss" class="doc_header"><code>class</code> <code>MultiTargetLoss</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/question_answering.py#L34" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiTargetLoss</code>(<strong><code>loss_classes</code></strong>=<em><code>[&lt;class 'fastai2.layers.CrossEntropyLossFlat'&gt;, &lt;class 'fastai2.layers.CrossEntropyLossFlat'&gt;]</code></em>, <strong><code>loss_classes_kwargs</code></strong>=<em><code>[{}, {}]</code></em>, <strong><code>weights</code></strong>=<em><code>[1, 1]</code></em>, <strong><code>reduction</code></strong>=<em><code>'mean'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Provides the ability to apply different loss functions to multi-modal targets/predictions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, we'll use a subset of pre-processed SQUAD v2 for our purposes below.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span>
<span class="n">squad_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;squad_sample.csv&#39;</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">squad_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1000</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>context</th>
      <th>question_id</th>
      <th>question_text</th>
      <th>is_impossible</th>
      <th>answer_text</th>
      <th>answer_start</th>
      <th>answer_end</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New_York_City</td>
      <td>The New York City Fire Department (FDNY), provides fire protection, technical rescue, primary response to biological, chemical, and radioactive hazards, and emergency medical services for the five boroughs of New York City. The New York City Fire Department is the largest municipal fire department in the United States and the second largest in the world after the Tokyo Fire Department. The FDNY employs approximately 11,080 uniformed firefighters and over 3,300 uniformed EMTs and paramedics. The FDNY's motto is New York's Bravest.</td>
      <td>56d1076317492d1400aab78c</td>
      <td>What does FDNY stand for?</td>
      <td>False</td>
      <td>New York City Fire Department</td>
      <td>4</td>
      <td>33</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cyprus</td>
      <td>Following the death in 1473 of James II, the last Lusignan king, the Republic of Venice assumed control of the island, while the late king's Venetian widow, Queen Catherine Cornaro, reigned as figurehead. Venice formally annexed the Kingdom of Cyprus in 1489, following the abdication of Catherine. The Venetians fortified Nicosia by building the Venetian Walls, and used it as an important commercial hub. Throughout Venetian rule, the Ottoman Empire frequently raided Cyprus. In 1539 the Ottomans destroyed Limassol and so fearing the worst, the Venetians also fortified Famagusta and Kyrenia.</td>
      <td>572e7f8003f98919007566df</td>
      <td>In what year did the Ottomans destroy Limassol?</td>
      <td>False</td>
      <td>1539</td>
      <td>481</td>
      <td>485</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s1">&#39;bert-large-uncased-whole-word-masking-finetuned-squad&#39;</span>
<span class="n">hf_tokenizer_cls</span> <span class="o">=</span> <span class="n">BertTokenizer</span>
<span class="n">hf_model_cls</span> <span class="o">=</span> <span class="n">HF_MODELS</span><span class="o">.</span><span class="n">BertForQuestionAnswering</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span>
                                                                               <span class="n">hf_tokenizer_cls</span><span class="p">,</span>
                                                                               <span class="n">hf_model_cls</span><span class="p">)</span>


<span class="c1"># # here&#39;s a pre-trained roberta model for squad you can try too</span>
<span class="c1"># pretrained_model_name = &quot;ahotrod/roberta_large_squad2&quot;</span>
<span class="c1"># hf_arch, hf_tokenizer, hf_config, hf_model = \</span>
<span class="c1">#     BLURR_MODEL_HELPER.get_auto_hf_objects(pretrained_model_name, task=HF_TASKS_AUTO.ForQuestionAnswering)</span>

<span class="c1"># # here&#39;s a pre-trained xlm model for squad you can try too</span>
<span class="c1"># pretrained_model_name = &#39;xlm-mlm-ende-1024&#39;</span>
<span class="c1"># hf_arch, hf_tokenizer, hf_config, hf_model = \</span>
<span class="c1">#     BLURR_MODEL_HELPER.get_auto_hf_objects(pretrained_model_name, task=HF_TASKS_AUTO.ForQuestionAnswering)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad_df</span> <span class="o">=</span> <span class="n">squad_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">pre_process_squad</span><span class="p">,</span> <span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Token indices sequence length is longer than the specified maximum sequence length for this model (16 &gt; 512). Running this sequence through the model will result in indexing errors
Token indices sequence length is longer than the specified maximum sequence length for this model (12 &gt; 512). Running this sequence through the model will result in indexing errors
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_seq_len</span><span class="o">=</span> <span class="mi">128</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad_df</span> <span class="o">=</span> <span class="n">squad_df</span><span class="p">[(</span><span class="n">squad_df</span><span class="o">.</span><span class="n">tokenized_input_len</span> <span class="o">&lt;</span> <span class="n">max_seq_len</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">squad_df</span><span class="o">.</span><span class="n">is_impossible</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">max_seq_len</span><span class="p">))</span>
<span class="c1"># vocab = dict(enumerate(range(max_seq_len)));</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># account for tokenizers that pad on right or left side</span>
<span class="n">trunc_strat</span> <span class="o">=</span> <span class="s1">&#39;only_second&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;only_first&#39;</span>
<span class="n">hf_batch_tfm</span> <span class="o">=</span> <span class="n">HF_BatchTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">max_seq_len</span><span class="p">,</span> <span class="n">truncation_strategy</span><span class="o">=</span><span class="n">trunc_strat</span><span class="p">,</span> 
                                 <span class="n">task</span><span class="o">=</span><span class="n">ForQuestionAnsweringTask</span><span class="p">())</span>

<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_batch_tfm</span><span class="o">=</span><span class="n">hf_batch_tfm</span><span class="p">),</span> 
    <span class="n">CategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">),</span>
    <span class="n">CategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">question_text</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">context</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">question_text</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">get_x</span><span class="p">,</span>
                   <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;tok_answer_start&#39;</span><span class="p">),</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;tok_answer_end&#39;</span><span class="p">)],</span>
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">(),</span>
                   <span class="n">n_inp</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">squad_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">),</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, (#128) [0,1,2,3,4,5,6,7,8,9...], (#128) [0,1,2,3,4,5,6,7,8,9...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>start/end</th>
      <th>answer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>what social status is the term " dialect " sometimes associated with? in many societies, however, a particular dialect, often the sociolect of the elite class, comes to be identified as the " standard " or " proper " version of a language by those seeking to make a social distinction, and is contrasted with other varieties. as a result of this, in some contexts the term " dialect " refers specifically to varieties with low social status. in this secondary sense of " dialect ", language varieties are often called dialects rather than languages :</td>
      <td>(87, 88)</td>
      <td>low</td>
    </tr>
    <tr>
      <th>1</th>
      <td>which physics subject was affected by the romantic movement? the romantic movement of the early 19th century reshaped science by opening up new pursuits unexpected in the classical approaches of the enlightenment. major breakthroughs came in biology, especially in darwin's theory of evolution, as well as physics ( electromagnetism ), mathematics ( non - euclidean geometry, group theory ) and chemistry ( organic chemistry ). the decline of romanticism occurred because a new movement, positivism, began to take hold of the ideals of the intellectuals after 1840 and lasted until about 1880.</td>
      <td>(59, 63)</td>
      <td>electromagnetism</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_QstAndAnsModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_QstAndAnsModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span><span class="o">=</span><span class="n">MultiTargetLoss</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>                <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice above how I had to define the loss function <em>after</em> creating the <code>Learner</code> object.  I'm not sure why, but the <a href="/blurr/02c_modeling-question-answering#MultiTargetLoss"><code>MultiTargetLoss</code></a> above prohibits the learner from being exported if I do.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([4, 128]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.012022644281387329, lr_steep=2.7542285919189453)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.635437</td>
      <td>2.996537</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.993480</td>
      <td>2.360842</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.372951</td>
      <td>2.283032</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>start/end</th>
      <th>answer</th>
      <th>pred start/end</th>
      <th>pred answer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>what was phillip's coronation song? phillips released " home " as his coronation song, while sanchez released " change nothing ". phillips'" home " has since become the best selling of all coronation songs.</td>
      <td>(13, 14)</td>
      <td>home</td>
      <td>(13, 14)</td>
      <td>home</td>
    </tr>
    <tr>
      <th>1</th>
      <td>what canadian network began airing american idol in 2015? american idol is broadcast to over 100 nations outside of the united states. in most nations these are not live broadcasts and may be tape delayed by several days or weeks. in canada, the first thirteen seasons of american idol were aired live by ctv and / or ctv two, in simulcast with fox. ctv dropped idol after its thirteenth season and in august 2014, yes tv announced that it had picked up canadian rights to american idol beginning in its 2015 season.</td>
      <td>(83, 85)</td>
      <td>yes tv</td>
      <td>(83, 84)</td>
      <td>yes</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">([{</span>
    <span class="s1">&#39;question_text&#39;</span><span class="p">:</span> <span class="s1">&#39;What did George Lucas make?&#39;</span><span class="p">,</span>
    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span>   
<span class="p">}],</span> 
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((&#39;11&#39;, &#39;13&#39;),
 tensor([11]),
 tensor([[5.3194e-05, 2.5182e-05, 3.5675e-06, 7.3832e-06, 2.6845e-06, 5.8212e-06,
          5.8091e-07, 5.3195e-05, 1.2779e-03, 1.0172e-04, 2.5046e-03, 9.9473e-01,
          8.8509e-05, 5.2585e-05, 5.9545e-05, 5.3455e-05, 5.0814e-04, 2.2526e-04,
          9.0487e-06, 7.0618e-05, 1.0867e-05, 5.3185e-05, 5.3322e-05, 4.7476e-07,
          5.1036e-07, 4.9558e-07, 4.9428e-07, 5.0055e-07, 5.1290e-07, 5.1966e-07,
          4.9342e-07, 5.0220e-07, 5.0476e-07, 4.9994e-07, 4.7383e-07, 4.6599e-07,
          4.8269e-07, 4.8138e-07, 4.6456e-07, 4.6713e-07, 4.7378e-07, 4.9016e-07,
          4.9878e-07, 4.8732e-07, 5.0685e-07, 5.0251e-07, 5.0099e-07, 5.0325e-07,
          5.0788e-07, 5.0637e-07, 5.1851e-07, 5.1880e-07, 5.1494e-07, 5.2493e-07,
          5.3766e-07, 5.3703e-07, 5.3932e-07, 5.2677e-07, 5.2705e-07, 5.4084e-07,
          5.3621e-07, 5.2246e-07, 5.1458e-07, 5.2556e-07, 5.3467e-07, 5.2497e-07,
          5.1146e-07, 5.1615e-07, 5.2185e-07, 5.3054e-07, 5.2399e-07, 5.2486e-07,
          5.3008e-07, 5.3529e-07, 5.3727e-07, 5.3913e-07, 5.3561e-07, 5.3981e-07,
          5.4040e-07, 5.3455e-07, 5.4207e-07, 5.5176e-07, 5.5754e-07, 5.7379e-07,
          5.4869e-07, 5.3730e-07, 5.4587e-07, 5.6493e-07, 5.5039e-07, 5.2119e-07,
          5.0298e-07, 5.1959e-07, 5.0731e-07, 4.5573e-07, 4.8999e-07, 4.6551e-07,
          4.8375e-07, 4.5512e-07, 4.1970e-07, 4.3704e-07, 4.2915e-07, 3.9470e-07,
          3.7808e-07, 4.0917e-07, 4.2922e-07, 4.6989e-07, 4.5286e-07, 4.3251e-07,
          4.3172e-07, 4.4357e-07, 4.8490e-07, 4.6904e-07, 4.7174e-07, 4.7709e-07,
          5.0116e-07, 5.0245e-07, 4.7073e-07, 4.4528e-07, 4.3949e-07, 4.3954e-07,
          4.1076e-07, 3.9264e-07, 4.4212e-07, 4.2858e-07, 4.3965e-07, 4.3281e-07,
          4.0487e-07, 4.1170e-07]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inp_ids</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;What did George Lucas make?&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">)</span>

<span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">inp_ids</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;star&#39;, &#39;wars&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that there is a bug currently in fastai v2 (or with how I'm assembling everything) that currently prevents us from seeing the decoded predictions and probabilities for the "end" token.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">([{</span>
    <span class="s1">&#39;question_text&#39;</span><span class="p">:</span> <span class="s1">&#39;When was Star Wars made?&#39;</span><span class="p">,</span>
    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span>
<span class="p">}],</span> 
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">inf_df</span><span class="p">)</span>
<span class="n">inp</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">,</span> <span class="n">with_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_decoded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> 
                                   <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;1977&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.170032</td>
      <td>2.075944</td>
      <td>00:14</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.679328</td>
      <td>1.910394</td>
      <td>00:14</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.641565</td>
      <td>1.890966</td>
      <td>00:14</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXQAAAD4CAYAAAD8Zh1EAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nO3dd3hT5/XA8e8r2ZI33gNsY5u9l1lhhISEANmT7NGkGSVtRtM2TX9t0iYdadq0SbNKs5pdAmSWlISEBAjTZu9lgw3egBdekt7fH1deYOOBZFnifJ5HT2zdq6vjG3x0fO5731dprRFCCOH9TJ4OQAghhGtIQhdCCB8hCV0IIXyEJHQhhPARktCFEMJH+HnqjaOjo3VKSoqn3l4IIbxSZmZmsdY6pqVtHkvoKSkpZGRkeOrthRDCKymlDra2TVouQgjhIyShCyGEj5CELoQQPsJjPXQhhOiouro6cnNzqa6u9nQobhcQEEBiYiL+/v7tfo0kdCGE18jNzSU0NJSUlBSUUp4Ox2201pSUlJCbm0tqamq7XyctFyGE16iuriYqKsqnkzmAUoqoqKgO/yUiCV0I4VV8PZnX68zP6TMJPa+0iq92FHg6DCGE8BifSehvfp/Nve9k4nDI/O5CCPc4fvw4L730UodfN3v2bI4fP+6GiJrzmYSeV1qN3aGpttk9HYoQwke1ltBtNttpX7d48WLCw8PdFVYDnxnlUlBmXDyorLETZPGZH0sI0Y08+uij7N+/n5EjR+Lv709AQAARERHs2rWLPXv2cMUVV5CTk0N1dTUPPPAAd999N9A41UlFRQWzZs1i8uTJrFq1il69evHJJ58QGBjokvh8JvMVltcAcKLWBlg9G4wQwu1++9l2dhwpc+kxB/cM4/FLh7S6/U9/+hPbtm1j06ZNfPvtt1x88cVs27atYWjh66+/TmRkJFVVVYwdO5arr76aqKioZsfYu3cv77//Pv/617+47rrrWLhwITfffLNL4veJhK61blahCyFEVxg3blyzceLPP/88H330EQA5OTns3bv3lISemprKyJEjARgzZgzZ2dkui8cnEnpFjY0TtUYiNyp0IYSvO10l3VWCg4Mbvv72229ZunQpq1evJigoiGnTprU4jtxqbewgmM1mqqqqXBaPT1wULSirafi6slYqdCGEe4SGhlJeXt7ittLSUiIiIggKCmLXrl2sWbOmi6PzkQq9sLzxU/BEjVToQgj3iIqKYtKkSQwdOpTAwEDi4uIats2cOZNXXnmFQYMGMWDAACZMmNDl8flGQpcKXQjRRd57770Wn7darXzxxRctbqvvk0dHR7Nt27aG5x955BGXxuYjLZcmFbr00IUQZykfSeg1+JuNeQ9klIsQ4mzlGwm9vJrEiCBMSip0IcTZyycSemFZNXFhVoItflKhCyHOWj6R0AvKaogLCyDIapYKXQhx1vL6hF5/l2hcWIBRocsoFyHEWcrrE3pZlY0am4PYUCuBFrOMQxdCdBshISEAHDlyhGuuuabFfaZNm0ZGRoZL3s/rE3qB86aixgpdEroQonvp2bMnCxYscPv7eH1Cr7+pqLGHLi0XIYR7PProo7z44osN3z/xxBM89dRTTJ8+ndGjRzNs2DA++eSTU16XnZ3N0KFDAaiqquL6669n0KBBXHnllS6dy8Xr7xStv6mofpRLztETHo5ICNElvngU8re69pjxw2DWn1rdPGfOHB588EHmzp0LwPz581myZAk/+clPCAsLo7i4mAkTJnDZZZe1uiboyy+/TFBQEDt37mTLli2MHj3aZeF7fUIvrjAq9KgQK0EWqdCFEO4zatQoCgsLOXLkCEVFRURERBAfH89DDz3E8uXLMZlMHD58mIKCAuLj41s8xvLly/nJT34CwPDhwxk+fLjL4mszoSulkoC3gDhAA/O01s+1sN804O+AP1CstT7XZVGeRo3NAUCAn4lgqx+VclFUiLPDaSppd7r22mtZsGAB+fn5zJkzh3fffZeioiIyMzPx9/cnJSWlxWlzu0J7eug24Kda68HABGCuUmpw0x2UUuHAS8BlWushwLUuj7QVtTYHJgV+ZlNDha61LBQthHCPOXPm8MEHH7BgwQKuvfZaSktLiY2Nxd/fn2XLlnHw4MHTvn7q1KkNE3xt27aNLVu2uCy2Nit0rXUekOf8ulwptRPoBexostuNwCKt9SHnfoUui7ANtXYHFj/jcynY6ofNoam1O7D6mbsqBCHEWWTIkCGUl5fTq1cvEhISuOmmm7j00ksZNmwY6enpDBw48LSvv++++7jjjjsYNGgQgwYNYsyYMS6LrUM9dKVUCjAKWHvSpv6Av1LqWyAUeE5r/VYLr78buBsgOTm549G2oNbmwGI2EnqQxUjiJ2rsktCFEG6zdWvjxdjo6GhWr17d4n4VFRWAsUh0/bS5gYGBfPDBB26Jq93DFpVSIcBC4EGt9ckrs/oBY4CLgYuAXyul+p98DK31PK11utY6PSYm5gzCblRjc2BxJu9gi/H5JGPRhRBno3ZV6Eopf4xk/q7WelELu+QCJVrrSqBSKbUcGAHscVmkrai1ObA6Wy5BVmeFLiNdhBBnoTYrdGUMpnwN2Km1fraV3T4BJiul/JRSQcB4YKfrwmxdsx56fYUuI12E8Flny6CHzvyc7anQJwG3AFuVUpuczz0GJDvf9BWt9U6l1P+ALYADeFVrva3Fo7lYrc1+ag9dKnQhfFJAQAAlJSVERUW1euOOL9BaU1JSQkBAQIde155RLiuBNs+c1voZ4JkOvbsL1Nqaj3IBqdCF8FWJiYnk5uZSVFTk6VDcLiAggMTExA69xuvvFG3acpEKXQjf5u/vT2pqqqfD6La8fnKupsMWGyp0GeUihDgL+UZCP7lCr7FTXFFDVnGlJ0MTQogu5fUJvaZZQm+s0J/4dDt3/nu9J0MTQogu5VM9dLNJEeBv4kStncyDxzhaWYvW2qevhgshRD2vr9BrbQ6s5sYfI9jix4GiSvJKq6mxOaiQES9CiLOETyT0+godjLtF12aVNHxfVF7jibCEEKLLeX9CtzdP6MEWP8qrG6vy4opaT4QlhBBdzvsTepNhi9A40qX+v/UrGgkhhK/zjYTetEJ3jkWf0i8akIQuhDh7eHVCdzg0Nodu3kN3VubTBsRiUtJDF0KcPbw6odfajfVET+6hA4xOjiAy2CIVuhDirOHVCb1+geimPfSIYAthAX70jQ0hOsRKUblcFBVCnB28+saiWmdCtzap0O8/ry9zxiZhNiliQq0USYUuhDhLeHdCb6HlEhFsISLYAkB0iJUDRTKfixDi7ODVLZf6Cr1pQm8qJtRKcUXNWbPCiRDi7OYbCd1sbnF7dIiFGpuDcrn9XwhxFvCNhN5KhR4dYgWgWIYuCiHOAl7eQzdWJjpdywWM2/9tjnJMCvrGhnZZfEII0ZW8ukJvadhiU/UVemF5NT94cz2/+WR7l8UmhBBdzbsr9Ha2XJZsLyD3WFWriV8IIXyBV2e4lsahNxUZbMGkYPHWPAAZky6E8GnendBbGIfelNmkiAy2YndoTArKq21U19m7MkQhhOgy3p3Q2+ihgzF0EWDW0ARAZl8UQvgu30jorVToAPE9AogOsXD5yJ6AzL4ohPBd3n1RtI2WC8BjswdRVWvH5FwoWhK6EMJXtVmhK6WSlFLLlFI7lFLblVIPnGbfsUopm1LqGteG2bL2VOj940IZkRROdKjRepEl6YQQvqo9FboN+KnWeoNSKhTIVEp9pbXe0XQnpZQZeBr40g1xtqitcehNRQUbQxilQhdC+Ko2M6HWOk9rvcH5dTmwE+jVwq4/BhYChS6N8DTac1G0nsXPRHiQv1wUFUL4rA5dFFVKpQCjgLUnPd8LuBJ4uY3X362UylBKZRQVFXUs0hbU2h34mxUmk2rX/jEhVqnQhRA+q90JXSkVglGBP6i1Ljtp89+BX2itHac7htZ6ntY6XWudHhMT0/FoT1Jrc3To7s/oEKtU6EIIn9WuUS5KKX+MZP6u1npRC7ukAx8oYyRJNDBbKWXTWn/sskhbUGtznPaC6MliQq1szj3uxoiEEMJz2kzoysjSrwE7tdbPtrSP1jq1yf5vAp+7O5lDxxN6dIhVptIVQvis9lTok4BbgK1KqU3O5x4DkgG01q+4KbY21do7XqFX1to5UWsjyOLVQ/CFEOIUbWY1rfVKoH1XHY39bz+TgDqioz30hvnRy2tJjpKELoTwLV5963+NzYHFr+Xl51pSP69LUUW1u0ISQgiP8eqE3pmWC0BRudwtKoTwPd6d0G12rB1puTgXvJB50YUQvsjLE3rHKvTIYAtKyaLRQgjf5N0JvYMtFz+zicggi1ToQgif5N0JvYOjXADiwgLIPVblpoiEEMJzvD+hd6BCBxie2IPNOcfRWrspKiGE8AyvTug1nUjoo5LDKa2qI6u40k1RCSGEZ3h1Qu9MhT4qOQKAjYdkThchhG/x/oTewR5635gQQq1+bMw55qaohBDCM7w6odfYHVg7WKGbTIrhST3YlCMVuhDCt3htQtdad6rlAjAqKYKdeeVU1drdEJkQQniG1yb0OrsxSqWjLRcwLozaHZqth0tdHZYQQniM1yb0WrtzPdFOVOgjk8IB2HhI+uhCCN/hvQnd1vmEHhVipVd4INuPnLySnhBCeK+zMqEDJEcGkXPshCtDEkIIj/L+hN6JHjpAUmSgTAEghPAp3pvQ7cYIlc5W6EkRQRSV11BdJyNdhBC+wWsTeo2zQu/oOPR6SZFBAORK20UI4SO8NqGfaQ89KTIQgJyj0nYRQvgG70/o5vavKdpUUoRRocuFUSGEr/DehH4G49ABokOsWPxM5ByVhC6E8A3em9DPsOViMikSI2SkixDCd3h/Qu/ksEUw2i7SchFC+ArvTehn2HIB48KoXBQVQviKNrOhUipJKbVMKbVDKbVdKfVAC/vcpJTaopTaqpRapZQa4Z5wG53psEUwKvTSqjrKqutcFZYQQnhMe7KhDfip1nowMAGYq5QafNI+WcC5WuthwJPAPNeGeaoz7aFD41h0uTAqhPAFbWZDrXWe1nqD8+tyYCfQ66R9Vmmt66cuXAMkujrQk9VX6AF+nRu2CE2GLkrbRQjhAzpU3iqlUoBRwNrT7HYn8EUrr79bKZWhlMooKirqyFufov6Wfat/5yv0xAjj5iK5WxTWHiih9IS0noTwZu3OhkqpEGAh8KDWusV5Z5VS52Ek9F+0tF1rPU9rna61To+JielMvA1q6hP6GbRcwoP8CbaYOXz87K7QK2ps3PCvNVz18vfkl1Z7OhwhRCe1Kxsqpfwxkvm7WutFrewzHHgVuFxrXeK6EFtWYzPWE1VKdfoYSiliQq0UV9S6MDLvk19ahUPD/qJKrv3nKo6c5R9wQnir9oxyUcBrwE6t9bOt7JMMLAJu0VrvcW2ILauusxPg3/n+eb2oECvF5TUuiKh1OUdPsDOv+y6mkeesyv/v4kEUltXwj2/2eTgiIURntKdCnwTcApyvlNrkfMxWSt2rlLrXuc9vgCjgJef2DHcFXK/G5iDgDPrn9aJDLJRUujehP/LhZmY9t4I73ljHgaIKt75XZ9Qn9IuGxHPlqF4s2pDLscrmf7XUjypq6tPNR5j+129lCmIhuon2jHJZqbVWWuvhWuuRzsdirfUrWutXnPvcpbWOaLI93d2BV9fZsZ7BCJd60SHubblordmVX86AuFAyso/xxGc73PZenZV33EjocWEB3D4phRqbg/fXH2rYnnnwKEMfX8K2kxbVfm3FAfYXVbLhoKzNKkR34LV3ilbXuaZCjwqxcuxELTb7qRWoKxytrKW0qo7rxiYxa1g8O46Utv2iLpZfVtUwWdnA+DDO6RPF26sPUuc8J59tzqPW7uCDJkl+b0E5m3ONn2XlvmKPxC2EaM5rE3qNzTUVekyIBa3h6An3VOkHiisBSIsJZmB8GMUVtRS5uWffUXml1ST0CGj4/o5JqeSVVrNkez5aa77eVQDAp5uONLRXFmzIxc+k6BcbIgldiG7CaxO6Kyt0gBI3tV32Fxo9874xIQxMCAVgV373ukCaX1pNfJOEfv7AWJIjg3jj+2z2FVaQc7SKmUPiKau28fXOQuwOzccbDzNtQAwXD09g6+FSjrvpA1EI0X5em9BrbK4Z5RLtTOjFFe6pmg8UV2LxM9EzPJCB8WEA7Mor7/BxtNZui/HkCt1sUtx2TgqZB4/x96V7Afi/SwYRHxbA++sO8exXuykoq+Hq0YlM7huN1rB6v9tHqgoh2uC1Cb26znFGNxXViwqxAO6r0A8UVZAWHYzZpIgMthAXZmVnJyr0dVlHSX9qKV9uz3dpfCdqbZRW1TWr0AGuTU8k2GLmv1vzGJwQRmJEEFeO7sXKfcW8uGw/FwyKZfqgOEYkhRNsMUvbRYhuwM/TAXRWtc2O1Qsq9P1FlQxytloABsaHdapC3+cc7vh/H29jfGoUPYL8XRJf/Z2hCScl9LAAf65NT+LNVdlcMCgWgDsnpwJw8bAEhvbq0bDvhLQovt1dRGlVHT0CXROXEKLjvLZCr3FRhR4W4IfFbHLL0MVam4NDR0/QJyak4bmBCaHsK6xoGEHSXvml1SgFJZW1PPXf1oc+FpXXkJF9FK31aY/3xdY8dueXNyT0+LDAU/a5c3IqwxN7cMUoYy626BArv5g5sFkyB7hxfDIFZdVc+o+VpwxtFEJ0He9N6C7qoSuliAqxuKVCP3S0ErtDkxYT3PDcwPhQau0OspyjX9orv7Sa2FArd09N48PMXPYUtFzlP/SfTVzzympm/G05S3cUtLhPdZ2dBz7YxFP/3dFwU9HJFToY0wt/ev9k0pp8ILVk+qA4/nPPBGptDm59fZ3caCSEh3hvQq9znNHUuU25K6HvLzKSdrMK3XlhtKNTAeSXVRMfFsAd56QAsGTbqb30LbnHWbmvmIuHJ2DXmgc+2Ehlja2F/UqptTtYtb+EHc44Tu6hd9SY3pE8O2cERytr+XxLXrNtCzJzefLzHfxvW54keyHcyGsTutFDd0340SFWl14U/WhjLve9k8mX240KOTW6sULvExOCn0mxs4N99IKyauLCAogNC2BUcjhftlB9v/LdfkID/PjTVcN45prhVNba+XzLEcCoyuuT6frsowDYHZoPM3KIDLa45K+diWlRpMUE8+7agw3P7Sus4NGFW3htZRb3vrOBn364+YzfRwjRMq9M6HaHps6uXVahG7f/u65Cf31lNl9sy2fhhlxiQ62EBjReKLT4mRgQH8rmnOMdOmbTseIXDYln6+HSZtP+ZhVX8sW2fG6d2JvQAH9GJ0fQLzaE99blUFpVx8y/L+e+dzIByMg+St/YEJIjgyirthEfdmbVeT2lFDeN783GQ8fZfqQUrTW//Ww7gRYzq395PjeMS+Kr7QWy5J8QbuKVCb3GduaLWzQVFWKhpKK2zQuJ7VFaVcf2I6X8YFIqD1/Ynwcu6HfKPuNSI9lw6FjDz9GWqlo7ZdU24pyJd8bgOAC+ajKE8bWVB/A3m7j9HGMkilKKG8YlsznnOLe/sY7skhMs213EvsIKMg4eY2xKJLOHJQAt988765rRiQT4m/jTF7v4y5e7WbG3mIcu6E9Cj0CuGZNIrd3BNzsLXfZ+QohGXpnQq+vql59zTfgxIVZq7Q7Kqpv3m7XWfLOroEPzvKzLOopDw4WD4/jJ9H7cNL73KfuMT42ixuZgS277RoTkl9WPRDESb1pMCP1iQxraLhU1Nj7acJhLh/ckJtTa8LqrRvfC4mdi46Hj3DM1DbNJ8bvPd1BebWNsSgQXOxP6mfbPm+oR5M/1Y5NZsdcYrz4wPpRbJhrnYFRSBPFhAfx3a14bRxFCdIZXjkOvr2xd0feFpjcX1TQbR705t5QfvJnBn64axvXjktt1rNX7S7D6mRiVHN7qPuNSIwFj2bexKZFtHrNhaGGTxDtjSByvfHeAvQXlrMs+SmWtnZsmNI8xPMjC3Gl9Ka6o4dFZA8kuqWSJs68/NiWSxIhAbhiXzKyhCe362drr8UsH88hFA6iottEj0B9/s/HBazIpZg6N5711hyivriM0wB+tNW+tPsjU/jHNrjUIITrOqyt0V14UBU4Zi77POQ9LSxcgW7P6QAljekec9sMmMtjCgLhQ1mYdbdcx88uMXnlck173beekEB7oz9z3NvD26oMMSghjVNKpHyIPXNCPJ68Y2tCCAaPST4wIRCnFH68axuR+0e3++dpDKUWI1Y/4HgEEWpqfh4uHJ1Brc/DNLqPtsiW3lMc/3c7fl3bJuihC+DSvTOgNFbqrhi0G10/Q1fzCaFaxkdBX7itucfjfyY5W1rIzr4yJaVFt7js+LZLMg8fadYNRfqkRV9MKPTY0gL/NGcnewgp25Zdz84TkNpfjm9LPqIKn9Ivu3NJ9h9bCaxfBd3+G3AxwdHwI4pjkCBJ6BPD26oNorXl/nTEl75fbCzhR2/Y5FkK0zisTussr9FCj5XLySJes4kr8TIpam4Ple4raPM7aA8YEVRP7tCOhp0ZxotbO1nbcWVlQVk2o1Y8Qa/MO2dT+MTx8QX9SooK4fGSvNo9jNik+uX8ST14xtM19W1R3Auw1sOwP8Op0+HMazL8NMv8Nx3PadQiTSTH3vL5kHDzGJ5uO8OnmIwyMD6Wqzs5SuVgqxBnxyh56/XhqV1XokUEWgi1mFm08zLXpSQ3tkgNFlUzqG82W3ON8uaOAWc6LiHV2B9uPlDHypBbH6gMlBPqbGZ7Yev+8Xn0f/Zn/7eb8gbENrYlLhicQHmRptm9+aTVxrVy4/PH0ftx/ft92V9xhAWcw10qf84xHZQkcWAb7l8H+b2DHx8b26P7Q53zjkTIZLC33xOeMTeK1lVn8fMEWau0O/njVMO57ZwOfbjrMZSN6dj4+Ic5yXpnQa2z1FbprErqf2cQz145g7nsbeHj+Jl64YTQA2SVGQo8JtfLl9nzq7A78zSYWZuby6KKtfHb/ZIYlNs5rsnp/CWNTI7G0Y/RNTKjVGJe9o4DVBxqnni0qr+GhC/s327f+LtHWdKp9ciaCo2DYNcZDayjaZST2/d8Y1fraV8DkD8kTGhN8/HAwGefF32zikRkDmPveBgYnhDEyKZxLhifw79XZHD9Re8oHmhCifby05eIch+6iYYsAs4cl8KvZg1i8NZ/5GTnkl1VTXecgNTqYCwfHUVZta1g7c5PzpqCFG3IbXl9YXs3ewop29c/r/fGq4WT834Vs+s2FrHtsOgPiQtnYwg1H9XeJdktKQewgmDgXbl4Iv8iGWz6GCfdB1XH4+rcw71z4Sz9YeBdseg/K85k9LJ5bJ/bm5zMHoJTi8pG9qLNrXv5uv6d/IiG8lldX6K4atljvzsmpvL3mIF/uKCA5MgiAtOhgBiUY869sOHSc8WlRbD9izH/y2eYj/OriQfibTaw5YIxYaU///GT1Feno3uEs3mos+1ZfddsdmsLyGuJ7WE93iO7DP6CxNQNQng8Hvm2s4Ld+CICKHcLv+pwHftOhbiJDe4UxJz2Jf353gB6B/vxoWl/P/QxCeCmvTOjuqNDBaF1M6x/D/IxcJvU1hvKlRAcTEWwhLTqYjYeMUSm788vpFxvC3sIKlu8pYvqgOFbvLyHE6sfQnmGdfv+RSeG8vy6HrOJKQqx+3Pr6OkYlR2B3aJfdnt/lQuNhxPXGw+GAgm2NyX3dPFj9AvgFoHqfwx/TziNiUC/+/L9dxIYGcM2YRE9HL4RX8cqEXlPn2huLmpo2IJZ/rz7I/PU5BPibGhLpyORwVuwtZk9BObV2B/ee24ffL97Joo2HmT4ojjUHShiXGomfufMfMiOTIgCjpVNUXsOu/HJ2O6fJ7bYtl44wmSBhuPGY/CDUVsLBVUZy3/c1pq9+zaPAPUGRfPvJMPKqriVh1CwIbn2cfK3NwdHKWpfe7SqEt/LOhN7QcnH9JYAJaVFY/EzsLihnYHwoJpPR+hiVHMGiDYcbZlAcmRzOpcMTeH9dDm9+n0VWcSU3jW/f3aSt6RsbQrDFzMZDx8k8eIyRSeE8ffVwvtiWx9T+MWf8s3U7lmDod6HxACjNhf3LCNz1Jeft+Ybwpd/BUiBhBHWp57M7OJ0h4y9E+TW2n3772XYWbTjMdz+bRqwvfOgJcQa8MqE3tlxcX6EHWsyMT41kxd7iZgtT1N+F+cH6QwRZzKRGBTP3vL5syi3lic+MFYQmdOCCaEvMJsXwxHC+2JZPcUUNj186mAHxoQyID237xb6gRyKMvoWA0bewblc+z779IRdZt3NZ5S7iVj3PUOzUfh2Ipc9U6Dudg+HjeX9dLg6t+OfyA/z6ksGe/gmE8CivTOg1NgcmBf5m9wzXmzYglhV7i5vNLTIwPpQAfxMFZTWk947AZFLEhgWw4N6J/H3pHnbllTM4ofP983ojk8NZfaAEkzJukz9bTR0YT/h9t/DYR1t5+nAZY+L9OM+6m7DDy7nqyE5C9i6hN7DSEs3esPEsWtuPkgk/Iio6ztOhC+ExbSZ0pVQS8BYQB2hgntb6uZP2UcBzwGzgBHC71nqD68M1VNcZy8+5a/z1+QNj+cPinQzp2TjG3M9sYnhiOOuyjjZbU9PfbOJnFw102XvX36w0qW80saFndwtheGI4H/9oEptzjzMyKQKb4wJueXUsv8k+yvjwMvqWr+MHCVlMKVvOueb/4njheeg1GvpON8a+90oHs1fWLEJ0Snv+tduAn2qtNyilQoFMpdRXWuumKxXPAvo5H+OBl53/dYtqFy0Q3ZrU6GBW/Py8U0aWjEo2EvrgMxjJ0pb03hGEWP24sZ2zO/o6P7OJMb2Nu2rNJjP/ui2dd9YcZGtuKUdsfeh50xhMZs1zb32AOesbbq89QMjyZ+C7p8EaBqlTG29uikz18E8jhHu1mdC11nlAnvPrcqXUTqAX0DShXw68pY0VItYopcKVUgnO17qcqxaIPp2e4YGnPDe5bzSvrsgivXeE2943KsTK5sdnYDZ18d2fXqJHoD9zzzt1jPqt113HVS8n8vrROj65azBJx9c3Do/c9bmxU2Rak6kJpkCA+z6YhfCEDv09qpRKAUYBa6/nJh8AAB0PSURBVE/a1AtoOjtTrvO5ZgldKXU3cDdAcnLnK1B3V+itmdIvhvW/uoDIYPfemi7JvOMigi28fvtYrnrpe+Z+lMWn918BQ64wpiYo2deY3De9D+tfBZMfJI5rTPA9R4LJvUWCEO7W7oSulAoBFgIPaq07tmS9k9Z6HjAPID09vdPrvXVFhd4adydz0Xmp0cHcN60Pf1i8i7zSKhJ6BBpTE0T3Mx7j7wFbDeSscyb4r2HZU8YjMALSpjUm+B5yU5PwPu1K6Eopf4xk/q7WelELuxwGkpp8n+h8zi2q6xwum5hL+Jap/WP4w+JdrNhbzHXpSafu4GeF1CnG44LHobLYmJpg39dGkt/+kbFf9IAm7ZlJrc4cKUR30p5RLgp4DdiptX62ld0+Be5XSn2AcTG01F39czAqdE+0XET3NyAulJhQa6sJvX4h8IYRUsHRzWeOLNzZWL1nvgFrXwazpcnMkdMhbmjDzJFCdCftqdAnAbcAW5VSm5zPPQYkA2itXwEWYwxZ3IcxbPEO14faqLrOQVjgGczrLXyWUoop/aJZtqsQh0M33Olbb84/19A7Kog/XzP81GGvSkHcYONxzv1QVwWHVjur92Ww9AnjERwDaecZwyPTzoNQGfsuuof2jHJZCZz2Kp1zdMtcVwXVluo6e7PV7YVoamq/GBZtOMz2I2XN5qs/VHKCddlHWZdt3Etw2zkppz+Qf2Bj2wWgLM85c6SzPbN1vvF83FDnDJPTIXmiMeOkEB7glXdd1NocHrsoKrq/+pkyl+8tapbQv91jLHE3KjmcJz/fwbDEHoxO7sAQ1LAEGHmD8XA4oGBrY+99zSuw6h/gFwC9JzXe3BQz0Kj8hegCXtkIrK6zEyA9dNGKmFArgxLC+Hjj4WYLfy/bVUhKVBBv3jGOuLAAHl24pV2LdLfIZIKEETDlYbj9c2Nhjxvnw5jboTQHljwGL02AZwfBxz+CrQuMpfuEcCOvzIo1NofLFogWvumnF/bn4NETXP7i9+zOL6e6zs6q/SVMGxBLj0B/Hr90MHsKKnh79UHXvKE1BPpfBLOehvvXw4Nb4dLnIWk87PovLLwTnukD/zwXvv4dZK8EW61r3lsIJ6/MikaFLi0X0boLBscx/56J1NoczJm3mjdXZVNjc3DewFgALhwcx5R+0fxt6R6Km1TxmQePUmtrX9WeVVzJP77ey6GSE6duDE+GMbfBdf+Gnx+Au76G8x4zWjIr/w5vXgx/ToX3roe186B4nzHKRogzoLSH/hGlp6frjIyMTr22z2OLuffcNJdOiiV808GSSub8cw35ZdUE+JvY9JsZDddf9hdVMONvy7l7ahq/mDmQnXllzHpuBT+cksqvLm57Kt4HPtjIJ5uOoBSMS4kkNTqYKf1i2p4ls7oUslY0Do88lm08H57ceBE2dapxs5MQJ1FKZWqt01va5nUVus3uwO7QUqGLdukdFcy7PxxPTKiVCwbFNbuY3icmhHP6RLFkez5Aw+Ilb67KJru48pRjFZXX8PK3+6mzO6ius7N0RwGzh8Vz/3l9qa6zs3hrHg/N30R5dd3pgwroAYMugUuehQc2w082wsV/hbhhsHUhzL8V/pwGr14Iy/4Ih9aC3ea6kyJ8lteNcql20wLRwnf1iQlhxc/Pa3HbjMFx/PqT7ewrLGfpzgL6xYZw5HgVv1+8k3/d2rwIevnb/bz+fRbhQf5EBFmorLVzw7hkpvSL4aczBpCRfZRrXlnN1zsLuWJUr/YHGJlmPMbeBfY6yM1orN6/exq++xNYe0Bak5kjI1LO4IwIX+V1Cb1+PVG5KCo6orUC4AJnQv/3qoNsPVzKL2YOxKE1zyzZzaX/WMnwxB787KIBBPibWbghF4Dnv97LsF49iAy2MLHJKlWjkyOIDwvgv1vzOpbQmzL7Q++JxuP8X8GJo5D1XePwyJ2fGftF9mnSnpkC1rNkVStxWl6X0BsqdGm5CBdI6BHIiMQevLPWGO1y4eBYkiKDqKmzs+HQcf6zPofSqjqmD4qltKqOuef14cVl+8krrebG8cnNFgU3mRSzhsXz7tpDlFfXERrggruZgyJhyJXGQ2so3tt4Y9Omd2H9v4yZI5PGO29uOh8SZObIs5X3JXSp0IWLzRgSz+bcUlKjg+kTE4JSiodnDADghW/28pcv97DmQAmp0cE8MmMAmQePsebAUS4ZdurFz0uGJ/DG99kdb7u0h1IQ0994TLjPmDny0JrGqYG/ecp4AJitxoga/wBjQjK/+v8GNv/ev+n3TR9NXx/Qwj6n2S43UnmM1yX0mjqjQnfHAtHi7DRjcBzPLNnNhYPjTpnf5d5z+/DVzkI25xzn7qlpKKX43eVDmb8+h/EtLAo+Kslou3y+5QzaLu3lZ4W0c43Hhb+FiiI4sMyY/91WA7Zq58P5dV2T70+UtLK9CnQnb7aqZ7a2kPRb+UDo7IdGS9vN1rN+0jSvS+jVNqNCD5AKXbhIv7hQXrl5NONTT03QfmYTz80ZybwVB5gz1liUpX9cKP93ScvDGk0mxWUje/L6yiyKymu6ds6hkBgYft2ZH8dua5LsW/pAqH+uqskHR40xmVnT71vbfqLk1O0u+zCxtPBXSCsfJC3+ldLWXzGtbO8mHyZel9ClQhfuMHNo62PHU6KD+cOVw9p9rDljk5i3/AALMnO5b1qfhuftDu0dq1GZ/cAcYtz92tXc/mFytPXt2n5msZst7f8LY+BsGHq1a85ZE16X0KVCF91dn5gQxqdG8sH6Q9wzNQ2TSaG1Zs4/VxMbZuWFG0afMq2vcOoWHyYnJ/yT2lWn/cA5zfaGD5NqiG9/gdARXpfQG4YtSoUuurEbxyfzwAebWH2ghEl9o9mZV07GwWMAPB+3lwcv6O/hCMUpPPlh4iJeV+aGB1mY0i+a8CBZ4EJ0XxcNiSc8yJ+3VmcD8NmWI5hNiouGxPH3pXtZmJmLp6bdEL7L6xL6hLQo3r5zPD3DAz0dihCtCvA3c+uE3izZXsCGQ8f4fMsRJvWN5rnrRzGmdwQ//XAzP3wrg6LymrYPJkQ7eV1CF8Jb3HNuH2JCrfz4vY3kHK3i0uEJBPib+c/dE/jV7EGs2FvME59u93SYwodIQhfCTYKtfjwyoz+Hj1dhMZuYMSQeMIZC/nBqGndOTmXxtjyyWpgITIjOkIQuhBtdMyaJkUnhzBwaT4+TFja/Y1IqFrOJf36330PRCV/jdaNchPAmZpNiwb0TMbVwO3xMqJXr0pP4YP0h5oxNYmB8GIEWGb0lOk8qdCHczM9sanXcef10Ale+tIphTyzhv1vyujg64UskoQvhQUmRQXz10FSeu34kA+JDeeKz7VTUyGIWonMkoQvhYb2jgrl8ZC9+f+UwispreOGbfZ4OSXgp6aEL0U2MTArn6tGJvL4yi6ziCkKs/vxi5gBiwwI8HZrwEpLQhehGfjFrAPllVWQXnyCruJKqOhsv3TTG02EJL9Fmy0Up9bpSqlApta2V7T2UUp8ppTYrpbYrpe5wfZhCnB1iQwN4964JLHloKj8+vy+Lt+azfE+Rp8MSXqI9PfQ3gZmn2T4X2KG1HgFMA/6qlLKceWhCnN3uPjeN1OhgHv90OzW2M5zaVZwV2kzoWuvlwNHT7QKEKmOplxDnvnKZXogzZPUz85tLBpNVXMnirTKcUbTNFaNcXgAGAUeArcADWre87IhS6m6lVIZSKqOoSP6MFKIt0wbE0DsqiPnrcz0divACrkjoFwGbgJ7ASOAFpVRYSztqredprdO11ukxMTEueGshfJtSimvHJLL6QAkHS2TOF3F6rkjodwCLtGEfkAUMdMFxhRDA1WMSMSlYkClVujg9VyT0Q8B0AKVUHDAAOOCC4wohgIQegUztH8OCzFzsDlkUQ7SuPcMW3wdWAwOUUrlKqTuVUvcqpe517vIkcI5SaivwNfALrXWx+0IW4uxzw7hk8kqr+WjjYU+HIrqxNm8s0lrf0Mb2I8AMl0UkhDjFjMFxjEgK5y9LdnPxsASZlVG0SOZyEcILKKX49cWDyC+r5l8rpKMpWiYJXQgvkZ4Syayh8bzy3X6KK9y7FunJC1hrrXnj+yxumLeGY5W1bn1v0XmS0IXwIj+7aADVdXb+tdw1VfrOvDKqapvfhbpoQy6jn/yKVfuNS2Fl1XXc/sZ6fvvZDlYfKOH5b/a65L2F60lCF8KLpMWEcNmInry1+uAZV+n7iyq4+PkV/OXL3Q3PvbriAA/P38yxE3U8/cUutNb8cfEuVu4r5snLh3DDuCTeXn1Q1kHtpiShC+Fl7j+/HzU2+xn30l/+dj8ODQs35FJdZ2fNgRKe+u9OZg2N58nLh7A5t5S/Ld3LB+sPcfs5KdwyMYWHLuyPxc/EE59uJ/PgUcqr61z0UwlXkIQuhJfpGxvCpSN68taqgxw/0bl+du6xE3y88TAjEntw/EQdS7bn8/ele4gNtfK3OSO5flwyvaOCeP7rvUSHWHnwgn6AMRvkA9P78d2eIq5+eTUXPPudJPVuRBK6EF7ovml9qKqz8966Q516/T+/O4BS8NLNY0iKDOTpL3ax5sBR7pvWhwB/M/5mEw9f2B+AX80eRGiAf8Nr7zm3D8semcafrxlOQVmN3MHajUhCF8ILDYwPY1LfKN5adZA6e4tz4bWqtKqO+Rk5XD06kV7hgcxJT+JIaTWxoVZuGJfcsN/lI3ux6tHzuWJUr1OOkRodzHXpSYxODufNVdk45A7WbkESuhBe6s7JqeSXVXd4at1PNx2mxubg5gm9Abg2PYlgi5kHL+hPgH/zG5Z6hgee9lh3TErlYMkJvtlV2LHghVtIQhfCS03rH0taTDCvrcw6Zdz46fwnI4fBCWEM7dUDgLiwADJ/fSE3jk9u45Wnmjk0nviwAF7/PqvVfR6ev4m/LNnd6nbhOpLQhfBSJpPi9nNS2JJbypbcUgBe+nYft7y2lp15ZYBxQ1BeaRUr9xaTe+wE24+Usu1wGXPGJjU71smVeXv5m03cOTmVVftLWLnXGLf+t6/28NTnOwDIOXqCRRsOM2/FAbffDCVkkWghvNoVo3rxx8W7eG/tIXqGB/Lc0r3U2Bxc8o+VDE4II6u4kooaYwExf7MiNToYi9nE5SN7uiyGW8/pzVtrsnny8x3cN60Pz31t3Hh0bXoSX2zLQymotTl4d80hHnCOlvFGDofm0NETpEQHN3v+k02HWbWvhKeuHIq/2bM1siR0IbxYWIA/l43oyaebj2A2K+rsDj6eO4mFmbnsK6zgqtG96BcbQkp0MJ9tPsKHmblcPqIn4UGuW/bX6mfmsVmDuO/dDTw8fxMjEnuwt7CCV77bT+bBY0xMi8LqZ+LtNdncc25ap/8a8LRnv9rDC8v28d4Px3NOn2gAquvs/O6zHZRU1hIS4MevLxns0RgloQvh5W4cn8x/MnJ4b+0hLhvRk5FJ4YxMCj9lvyn9YvjJ9H5EuDCZ15s5NJ4JaZHsOFLGizeN5rWVWbzxfTYAD0zvR1xYADe/tpZPNx/huvSkVo+jtWbJ9gLO6RtFmHOo5MGSStZnH6O4ooa7Jqfi54YqePuRUvrHhbZaYR+rrOUN53WCxxZt5X8PTiXA38yHGTmUVNZyTp8oXluZxYikcC4b4bq/fjpKeuhCeLnhiT0Y2stY9XHueX1Pu29iRBDBVtfXcUop3rh9HF//dBqJEUHcNSUNP5MiyGJm5tB4JvWNYnBCGC98s49aW+vDLJdsL+DedzK5+PkVLNmez91vZXDuM9/yyIeb+dMXu3htZesXXzsrr7SKS/6xkt99ZvT9S6vqePnb/c0mIXttZRYn6uw8fulgsktO8OxXe6izO5i34gAjk8J5845xpPeO4JH5m/lqR4HLY2wvSehCeDmlFL+9bCi/v3IoA+JDPRZHoMVMTKgVgF7hgTx0YX8emN6PYKsfSil+NnMAh46e4L21B1s9xoLMHKKCLdjtmnvezuT7fcU8fGF/vnxoKjMGx/HsV3vIdvE8MnsLKtAa3l5zkG92FfDDf2fw9P92cee/11NdZ6ewvJo3V2Uze2gCd0xK5doxicxbfoDRT35FztEq7pvWB4ufidduG8ugnmHc904mr63MoqCs2qVxtofqyHAnV0pPT9cZGRkeeW8hRNfTWnPjv9ayu6Cc7342rdndpwCF5dVM/OM33DUllfvO7cOiDYe5ZHgCsWEBABSUVXPBX79jWGIP3r1rPEqphtfaHRq7Q2Px63iN+tbqbH7zyXYSegSQ70zCN4/vzTtrDzK0Zw+yiiupsdn57MeTGRgfRq3NwRfb8vhyRwFo+McNozCZjFjKq+v44VsZrDlwFIDbz0nhicuGdOZ0tUoplam1Tm9pm1ToQoguoZTil7MHcrSylnktTP/78cbD2B2aa8ckER5k4QeTUxuSORjj5R+dPZBV+0tYvDW/2Wuf+HQ7s55bjq2Dd80CHCiqJMhi5oUbRxNq9eOJS4fw5BVDefySwWw/UsrU/tF8/uMpDIw32loWPxOXj+zFizeO5sWbRjckc4DQAH/e/+EE/vfgFC4f2ZN/r85mV35Zh2PqLEnoQoguMzwxnEuGJ/DqiiwKm7QktNbMz8hldHI4fWNDWn399WOTGZQQxh8W76S6zpjH/fiJWuZn5LC/qLJT/evskkpSooIZ0zuCjb+ZwW3npABw+6RUtv32Il66aUyHWllKKQbGh/Hby4YQYvHjr1/u6XBMnSUJXQjRpX520QBsDgd/W9q4UMamnOPsK6zg2tOMgAEwmxS/vmQQh49XNVwgXZCZS43NQUSQ/2nvWG1NdnElqc6x5eYm1TZAkKXzF5DDgyz8cGoaX+0oYOOhY50+TkdIQhdCdKneUcHcNL438zNy2FdYAcCHmbkE+Ju4ZHhCm68/p080MwbH8Y9v9rJsdyHvrT3E6ORw5p7Xl/XZx9iSe7zdsdTZHeQcqyIlOqjTP8/p/GByKlHBFm5+dS2/+2wHucdOuOV96klCF0J0uR+f35dAfzO/+3wH1XV2Ptt8hFlDE065UNqa3185jLToEH7w5noOFFdy84TeXDfWmGTsuaV7G4ZG7issP+1ok5yjJ7A7NKnRrbd5zkSI1Y//3DOBGUPieWt1Ns9+5d72i9xYJIToclEhVh6+sD+/+3wHP52/mfJqG9eOSWz362NCrfznngnc984GsoormT0sgQB/M3PP78uf/7ebq17+npSoYD7fkseIpHA+mTupxeNklxhDIFPdVKED9I0N5W9zRvKziwbgcPOoQknoQgiPuHVibz7MzOW/W/NIjAhkQlpUh14fGuDP23eOo8bmaJhO4EfT+tInJoRHF25hf2Elk/pG8f2+ErbkHmd44ql3z2YVGy2QlKjgU7a5WltTEbuCtFyEEB7hZzbx1BVDUQquS09qNvyvvZRSp8wNc9GQeJY9Mo1Vj57PyzePIdDfzDtrWr6ZKau4grAAPyKDXT8dgie0mdCVUq8rpQqVUttOs880pdQmpdR2pdR3rg1RCOGrxvSO4KuHpnLvuX1cetzwIAsRwRbCAvy5YpQxeVnpiVPXPs0uPkFqdHCzm5S8WXsq9DeBma1tVEqFAy8Bl2mthwDXuiY0IcTZoG9saKfu8Gyvm8b3prrOwbwV+09ZCCSruPKU6XC9WZtnUWu9HDh6ml1uBBZprQ8595e1qIQQ3cbQXj2YMTiOF5ft56ZX13KoxOib7yus4EhpVcMYdF/gio/F/kCEUupbpVSmUupWFxxTCCFc5pWbx/D7K4ey9XApl/xjBR9tzOW219cRFWzh6tHtH13T3blilIsfMAaYDgQCq5VSa7TWpwy4VErdDdwNkJzc8fULhRCiM0wmxU3jezOlbwx3v53BQ//ZTLDFzAd3TyQp0n1DFruaKxJ6LlCita4EKpVSy4ERwCkJXWs9D5gHxmyLLnhvIYRot+SoIBb96Bye/3of5w+MZVhiD0+H5FKuaLl8AkxWSvkppYKA8cBOFxxXCCFcLsjix6OzBjIuNdLTobhcmxW6Uup9YBoQrZTKBR4H/AG01q9orXcqpf4HbAEcwKta61aHOAohhHCPNhO61vqGduzzDPCMSyISQgjRKXKnqBBC+AhJ6EII4SMkoQshhI+QhC6EED5CEroQQvgISehCCOEj1Mmzj3XZGytVBLQ0SXE0UNzF4bRHd40LJLbOktg6rrvGBWdPbL211jEtbfBYQm+NUipDa53u6ThO1l3jAomtsyS2juuucYHEBtJyEUIInyEJXQghfER3TOjzPB1AK7prXCCxdZbE1nHdNS6Q2LpfD10IIUTndMcKXQghRCdIQhdCCB/RbRK6UmqmUmq3UmqfUupRD8eSpJRappTaoZTarpR6wPl8pFLqK6XUXud/IzwUn1kptVEp9bnz+1Sl1FrnufuPUsriobjClVILlFK7lFI7lVITu9E5e8j5/3KbUup9pVSAp86bUup1pVShUmpbk+daPE/K8Lwzxi1KqdEeiO0Z5//TLUqpj5RS4U22/dIZ226l1EVdHVuTbT9VSmmlVLTze4+fN+fzP3aeu+1KqT83ed49501r7fEHYAb2A2mABdgMDPZgPAnAaOfXoRjL6Q0G/gw86nz+UeBpD8X3MPAe8Lnz+/nA9c6vXwHu81Bc/wbucn5tAcK7wzkDegFZQGCT83W7p84bMBUYDWxr8lyL5wmYDXwBKGACsNYDsc0A/JxfP90ktsHO31UrkOr8HTZ3ZWzO55OAJRg3KkZ3o/N2HrAUsDq/j3X3eXP7P952noyJwJIm3/8S+KWn42oSzyfAhcBuIMH5XAKw2wOxJAJfA+cDnzv/wRY3+YVrdi67MK4ezqSpTnq+O5yzXkAOEImxqMvnwEWePG9Aykm//C2eJ+CfwA0t7ddVsZ207UrgXefXzX5PnUl1YlfHBizAWMc4u0lC9/h5wygYLmhhP7edt+7Scqn/hauX63zO45RSKcAoYC0Qp7XOc27KB+I8ENLfgZ9jLPcHEAUc11rbnN976tylAkXAG8520KtKqWC6wTnTWh8G/gIcAvKAUiCT7nHe6rV2nrrb78YPMCpf6AaxKaUuBw5rrTeftMnjsQH9gSnOtt53Sqmx7o6tuyT0bkkpFQIsBB7UWpc13aaNj9YuHfOplLoEKNRaZ3bl+7aTH8afnC9rrUcBlRitgwaeOGcAzn705RgfOj2BYGBmV8fRXp46T21RSv0KsAHvejoWAOei9I8Bv/F0LK3ww/ircALwM2C+Ukq58w27S0I/jNEHq5fofM5jlFL+GMn8Xa31IufTBUqpBOf2BKCwi8OaBFymlMoGPsBouzwHhCul6teH9dS5ywVytdZrnd8vwEjwnj5nABcAWVrrIq11HbAI41x2h/NWr7Xz1C1+N5RStwOXADc5P3DA87H1wfiQ3uz8nUgENiil4rtBbGD8TizShnUYf1VHuzO27pLQ1wP9nKMOLMD1wKeeCsb5KfoasFNr/WyTTZ8Ctzm/vg2jt95ltNa/1Fonaq1TMM7RN1rrm4BlwDWeissZWz6Qo5Qa4HxqOrADD58zp0PABKVUkPP/bX1sHj9vTbR2nj4FbnWO2pgAlDZpzXQJpdRMjDbfZVrrE002fQpcr5SyKqVSgX7Auq6KS2u9VWsdq7VOcf5O5GIMZsinG5w34GOMC6MopfpjDBQoxp3nzZ0XCTp4QWE2xmiS/cCvPBzLZIw/ebcAm5yP2Rj96q+BvRhXryM9GOM0Gke5pDn/QewDPsR5Vd0DMY0EMpzn7WMgorucM+C3wC5gG/A2xggDj5w34H2MXn4dRhK6s7XzhHHR+0Xn78VWIN0Dse3D6PnW/y680mT/Xzlj2w3M6urYTtqeTeNF0e5w3izAO85/cxuA89193uTWfyGE8BHdpeUihBDiDElCF0IIHyEJXQghfIQkdCGE8BGS0IUQwkdIQhdCCB8hCV0IIXzE/wMWKjzbeb/XHAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>start/end</th>
      <th>answer</th>
      <th>pred start/end</th>
      <th>pred answer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>what was phillip's coronation song? phillips released " home " as his coronation song, while sanchez released " change nothing ". phillips'" home " has since become the best selling of all coronation songs.</td>
      <td>(13, 14)</td>
      <td>home</td>
      <td>(13, 14)</td>
      <td>home</td>
    </tr>
    <tr>
      <th>1</th>
      <td>what covers crimes of human against human? tort law covers the entire imaginable spectrum of wrongs which humans can inflict upon each other, and of course, partially overlaps with wrongs also punishable by criminal law. although the american law institute has attempted to standardize tort law through the development of several versions of the restatement of torts, many states have chosen to adopt only certain sections of the restatements and to reject others. thus, because of its immense size and diversity, american tort law cannot be easily summarized.</td>
      <td>(10, 13)</td>
      <td>tort law</td>
      <td>(10, 12)</td>
      <td>tort</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((&#39;14&#39;, &#39;15&#39;),
 tensor([14]),
 tensor([[3.0867e-04, 1.2444e-04, 2.4383e-05, 1.5669e-05, 9.0843e-06, 3.9796e-05,
          5.9674e-06, 3.0868e-04, 3.3698e-04, 6.9216e-05, 2.4023e-04, 7.7564e-04,
          2.7790e-05, 1.9756e-02, 9.7701e-01, 2.2262e-05, 1.9347e-05, 1.6926e-05,
          5.6000e-06, 1.2451e-05, 1.4314e-05, 3.0862e-04, 3.0845e-04, 2.2041e-06,
          2.3125e-06, 2.2788e-06, 2.2946e-06, 2.2506e-06, 2.2822e-06, 2.2508e-06,
          2.2567e-06, 2.2429e-06, 2.2786e-06, 2.2924e-06, 2.2297e-06, 2.2543e-06,
          2.2442e-06, 2.2279e-06, 2.2162e-06, 2.1983e-06, 2.1759e-06, 2.2006e-06,
          2.2434e-06, 2.2455e-06, 2.2535e-06, 2.2384e-06, 2.2207e-06, 2.2545e-06,
          2.2500e-06, 2.2546e-06, 2.3021e-06, 2.2912e-06, 2.2854e-06, 2.3152e-06,
          2.3121e-06, 2.3356e-06, 2.3522e-06, 2.3417e-06, 2.3099e-06, 2.3784e-06,
          2.4011e-06, 2.3536e-06, 2.3640e-06, 2.3542e-06, 2.3410e-06, 2.3329e-06,
          2.3333e-06, 2.3147e-06, 2.3155e-06, 2.4173e-06, 2.3482e-06, 2.3661e-06,
          2.3704e-06, 2.3973e-06, 2.4074e-06, 2.4576e-06, 2.4052e-06, 2.3944e-06,
          2.4378e-06, 2.4208e-06, 2.4562e-06, 2.4148e-06, 2.4618e-06, 2.5029e-06,
          2.4561e-06, 2.4216e-06, 2.4173e-06, 2.4702e-06, 2.4227e-06, 2.3557e-06,
          2.3491e-06, 2.3999e-06, 2.3479e-06, 2.3472e-06, 2.2936e-06, 2.2730e-06,
          2.3073e-06, 2.2456e-06, 2.1464e-06, 2.1644e-06, 2.1702e-06, 2.1342e-06,
          2.1087e-06, 2.1297e-06, 2.1523e-06, 2.3058e-06, 2.2554e-06, 2.1650e-06,
          2.1860e-06, 2.2145e-06, 2.2360e-06, 2.2185e-06, 2.1886e-06, 2.1974e-06,
          2.3069e-06, 2.3112e-06, 2.2463e-06, 2.2266e-06, 2.2153e-06, 2.1990e-06,
          2.1849e-06, 2.1748e-06, 2.1831e-06, 2.1432e-06, 2.1499e-06, 2.1677e-06,
          2.1221e-06, 2.1287e-06]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">,</span> <span class="n">pred_classes</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;14&#39;, &#39;15&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inp_ids</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;When was Star Wars made?&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">)</span>

<span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">inp_ids</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="nb">int</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span><span class="nb">int</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;1977&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And what about inference?</p>
<p>Note that I had to replace the loss function because of the above-mentioned issue to exporting the model with the <a href="/blurr/02c_modeling-question-answering#MultiTargetLoss"><code>MultiTargetLoss</code></a> loss function.  After getting our inference learner, we put it back and we're good to go!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;q_and_a_learn_export.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;q_and_a_learn_export.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">MultiTargetLoss</span><span class="p">()</span>

<span class="n">inf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">([</span>
    <span class="p">{</span><span class="s1">&#39;question_text&#39;</span><span class="p">:</span> <span class="s1">&#39;Who created Star Wars?&#39;</span><span class="p">,</span> 
     <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">}],</span>
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="n">inf_learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((&#39;7&#39;, &#39;9&#39;),
 tensor([7]),
 tensor([[5.7523e-05, 7.9506e-06, 2.2961e-06, 7.9322e-06, 1.5358e-06, 9.2119e-07,
          5.7529e-05, 9.9895e-01, 5.5491e-04, 5.4612e-06, 7.3313e-05, 1.8145e-06,
          1.5339e-05, 4.9108e-05, 2.1250e-06, 3.5801e-05, 3.6310e-06, 9.9062e-07,
          2.0901e-06, 1.2587e-06, 5.7523e-05, 5.7054e-05, 4.6828e-07, 5.1951e-07,
          4.9394e-07, 4.9258e-07, 5.0625e-07, 5.0280e-07, 5.0132e-07, 4.8223e-07,
          4.8296e-07, 5.3754e-07, 5.1656e-07, 4.8328e-07, 4.7566e-07, 4.8324e-07,
          4.7585e-07, 4.7161e-07, 4.8362e-07, 4.7726e-07, 4.8153e-07, 4.9058e-07,
          4.9861e-07, 4.9663e-07, 5.0841e-07, 5.0451e-07, 4.9855e-07, 5.0658e-07,
          5.0613e-07, 5.2566e-07, 5.3498e-07, 5.2130e-07, 5.1281e-07, 5.2208e-07,
          5.2479e-07, 5.2280e-07, 5.1981e-07, 5.1333e-07, 5.4853e-07, 5.5235e-07,
          5.1898e-07, 5.1866e-07, 5.1716e-07, 5.1284e-07, 5.1899e-07, 5.1761e-07,
          5.1516e-07, 5.1323e-07, 5.2506e-07, 5.3456e-07, 5.2130e-07, 5.2378e-07,
          5.2519e-07, 5.2863e-07, 5.2129e-07, 5.2192e-07, 5.1886e-07, 5.8156e-07,
          5.1428e-07, 5.2178e-07, 5.2669e-07, 5.2442e-07, 5.3234e-07, 5.3115e-07,
          5.1780e-07, 5.5543e-07, 5.6960e-07, 5.5695e-07, 4.9808e-07, 5.0072e-07,
          5.0030e-07, 4.6085e-07, 4.3974e-07, 4.7457e-07, 4.3299e-07, 4.9865e-07,
          4.3649e-07, 4.3037e-07, 4.4446e-07, 4.3516e-07, 4.3631e-07, 4.1941e-07,
          4.2490e-07, 4.3755e-07, 4.9835e-07, 5.2250e-07, 4.5344e-07, 4.4956e-07,
          4.6115e-07, 4.6421e-07, 4.7496e-07, 4.7481e-07, 4.7083e-07, 5.0918e-07,
          5.3172e-07, 4.7596e-07, 4.5179e-07, 4.3710e-07, 4.5207e-07, 4.3465e-07,
          4.3178e-07, 4.6626e-07, 4.4386e-07, 4.6313e-07, 4.5915e-07, 4.4612e-07,
          4.5224e-07, 4.4735e-07]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inp_ids</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Who created Star Wars?&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">)</span>

<span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">inp_ids</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">7</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;george&#39;, &#39;lucas&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

